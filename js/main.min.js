function playground(t){return new PLAYGROUND.Application(t)}!function(){var t=function(e,i){return"function"==typeof t.cache[i]?t.cache[i](e):t.spline(e,i||t.defaultEasing)},e=function(){for(var t=1;t<arguments.length;t++)for(var e in arguments[t])arguments[0][e]=arguments[t][e];return arguments[0]};e(t,{defaultEasing:"016",cache:{linear:function(t){return t},inQuad:function(t){return t*t},outQuad:function(t){return t*(2-t)},inOutQuad:function(t){return.5>t?2*t*t:-1+(4-2*t)*t},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return.5>t?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},inQuart:function(t){return t*t*t*t},outQuart:function(t){return 1- --t*t*t*t},inOutQuart:function(t){return.5>t?8*t*t*t*t:1-8*--t*t*t*t},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return 1+--t*t*t*t*t},inOutQuint:function(t){return.5>t?16*t*t*t*t*t:1+16*--t*t*t*t*t},inSine:function(t){return-1*Math.cos(t/1*(.5*Math.PI))+1},outSine:function(t){return Math.sin(t/1*(.5*Math.PI))},inOutSine:function(t){return-0.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t){return 0==t?0:Math.pow(2,10*(t-1))},outExpo:function(t){return 1==t?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t){return 0==t?0:1==t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t){return-1*(Math.sqrt(1-t*t)-1)},outCirc:function(t){return Math.sqrt(1-(t-=1)*t)},inOutCirc:function(t){return(t/=.5)<1?-0.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t){var e=1.70158,i=0,n=1;if(0==t)return 0;if(1==t)return 1;if(i||(i=.3),1>n){n=1;var e=i/4}else var e=i/(2*Math.PI)*Math.asin(1/n);return-(n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i))},outElastic:function(t){var e=1.70158,i=0,n=1;if(0==t)return 0;if(1==t)return 1;if(i||(i=.3),1>n){n=1;var e=i/4}else var e=i/(2*Math.PI)*Math.asin(1/n);return n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/i)+1},inOutElastic:function(t){var e=1.70158,i=0,n=1;if(0==t)return 0;if(2==(t/=.5))return 1;if(i||(i=.3*1.5),1>n){n=1;var e=i/4}else var e=i/(2*Math.PI)*Math.asin(1/n);return 1>t?-.5*(n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)):n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*.5+1},inBack:function(t,e){return void 0==e&&(e=1.70158),1*t*t*((e+1)*t-e)},outBack:function(t,e){return void 0==e&&(e=1.70158),1*((t=t/1-1)*t*((e+1)*t+e)+1)},inOutBack:function(t,e){return void 0==e&&(e=1.70158),(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},inBounce:function(t){return 1-this.outBounce(1-t)},outBounce:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},inOutBounce:function(t){return.5>t?.5*this.inBounce(2*t):.5*this.outBounce(2*t-1)+.5}},translateEasing:function(t){if(!this.cache[t]){for(var e=t.split(""),i=1,n=!1,s=!1,o=0;o<e.length;o++){var r=e[o];"-"===r?(i=-1,n=!0,e.splice(o--,1)):"+"===r?(i=1,e.splice(o--,1)):"t"===r?(s=!s,e.splice(o--,1)):e[o]=parseInt(e[o],16)*i}for(var a=Math.min.apply(null,e),h=Math.max.apply(null,e),u=h-a,l=[],o=0;o<e.length;o++){if(n)var u=Math.max(Math.abs(a),Math.abs(h)),c=e[o]/u;else var u=h-a,c=(e[o]-a)/u;s&&(0>c&&(c=0),c>1&&(c=1)),l.push(c)}this.cache[t]=l}return this.cache[t]},splineK:{},splineX:{},splineY:{},insertIntermediateValues:function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]),i<t.length-1&&e.push(t[i+1]+.6*(t[i]-t[i+1]));return e},spline:function(t,e){if(!this.splineK[e]){var i=[],n=this.translateEasing(e);if(!n.length)return 0;for(var s=0;s<n.length;s++)i.push(s*(1/(n.length-1)));var o=i.map(function(){return 0});o=this.getNaturalKs(i,n,o),this.splineX[e]=i,this.splineY[e]=n,this.splineK[e]=o}if(t>1)return this.splineY[e][this.splineY[e].length-1];for(var o=this.splineK[e],i=this.splineX[e],n=this.splineY[e],s=1;i[s]<t;)s++;var r=(t-i[s-1])/(i[s]-i[s-1]),a=o[s-1]*(i[s]-i[s-1])-(n[s]-n[s-1]),h=-o[s]*(i[s]-i[s-1])+(n[s]-n[s-1]),u=(1-r)*n[s-1]+r*n[s]+r*(1-r)*(a*(1-r)+h*r);return u},getNaturalKs:function(t,e,i){for(var n=t.length-1,s=this.zerosMat(n+1,n+2),o=1;n>o;o++)s[o][o-1]=1/(t[o]-t[o-1]),s[o][o]=2*(1/(t[o]-t[o-1])+1/(t[o+1]-t[o])),s[o][o+1]=1/(t[o+1]-t[o]),s[o][n+1]=3*((e[o]-e[o-1])/((t[o]-t[o-1])*(t[o]-t[o-1]))+(e[o+1]-e[o])/((t[o+1]-t[o])*(t[o+1]-t[o])));return s[0][0]=2/(t[1]-t[0]),s[0][1]=1/(t[1]-t[0]),s[0][n+1]=3*(e[1]-e[0])/((t[1]-t[0])*(t[1]-t[0])),s[n][n-1]=1/(t[n]-t[n-1]),s[n][n]=2/(t[n]-t[n-1]),s[n][n+1]=3*(e[n]-e[n-1])/((t[n]-t[n-1])*(t[n]-t[n-1])),this.solve(s,i)},solve:function(t,e){for(var i=t.length,n=0;i>n;n++){for(var s=0,o=Number.NEGATIVE_INFINITY,r=n;i>r;r++)t[r][n]>o&&(s=r,o=t[r][n]);this.splineSwapRows(t,n,s);for(var r=n+1;i>r;r++){for(var a=n+1;i+1>a;a++)t[r][a]=t[r][a]-t[n][a]*(t[r][n]/t[n][n]);t[r][n]=0}}for(var r=i-1;r>=0;r--){var h=t[r][i]/t[r][r];e[r]=h;for(var a=r-1;a>=0;a--)t[a][i]-=t[a][r]*h,t[a][r]=0}return e},zerosMat:function(t,e){for(var i=[],n=0;t>n;n++){i.push([]);for(var s=0;e>s;s++)i[n].push(0)}return i},splineSwapRows:function(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}}),window.ease=t}(),window.PLAYGROUND={},PLAYGROUND.MOBILE=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),PLAYGROUND.Utils={extend:function(){for(var t=1;t<arguments.length;t++)for(var e in arguments[t])arguments[0][e]=arguments[t][e];return arguments[0]},defaults:function(){for(var t=1;t<arguments.length;t++)for(var e in arguments[t])"undefined"==typeof arguments[0][e]&&(arguments[0][e]=arguments[t][e]);return arguments[0]},merge:function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i){var s=i[n];"undefined"!=typeof t[n]&&"object"==typeof t[n]?this.merge(t[n],s):t[n]=s}}return t},invoke:function(t,e){for(var i=Array.prototype.slice.call(arguments,2),n=0;n<t.length;n++){var s=t[n];s[e]&&s[e].apply(s,i)}},throttle:function(t,e){var i,n=0;return function(){for(var s=[],o=0;o<arguments.length;o++)s.push(arguments[o]);var r=this;Date.now()-n>e?(n=Date.now(),t.apply(r,s),clearTimeout(i)):(clearTimeout(i),i=setTimeout(function(){t.apply(r,s),n=Date.now()},Date.now()-n))}},wrapTo:function(t,e,i,n){if(t===e)return e;var s=t,o=this.wrappedDistance(t,e,i);return Math.abs(o)<n?e:(s+=(0>o?-1:1)*n,s>i?s-=i:0>s&&(s=i+s),s)},wrap:function(t,e,i){return e>t?i+t%i:t>=i?t%i:t},circWrap:function(t){return this.wrap(t,0,2*Math.PI)},circWrapTo:function(t,e,i){return this.wrapTo(t,e,2*Math.PI,i)},wrappedDistance:function(t,e,i){if(t===e)return 0;if(e>t)var n=-t-i+e,s=e-t;else var n=e-t,s=i-t+e;return Math.abs(n)>Math.abs(s)?s:n},circWrappedDistance:function(t,e){return this.wrappedDistance(t,e,2*Math.PI)},ground:function(t,e){return(t/e|0)*e},circDistance:function(t,e){return this.circWrappedDistance(t,e)},distance:function(t,e,i,n){if(arguments.length>2){var s=t-i,o=e-n;return Math.sqrt(s*s+o*o)}var s=t.x-e.x,o=t.y-e.y;return Math.sqrt(s*s+o*o)},sprintf:function(t,e){for(var i in e){var n=new RegExp("{"+i+"}","g");t=t.replace(n,e[i])}return t}},PLAYGROUND.Utils.ease=ease,PLAYGROUND.Events=function(){this.listeners={}},PLAYGROUND.Events.prototype={on:function(t,e,i){if("object"==typeof t){var n={};for(var s in t)n[s]=this.on(s,t[s],i);return n}this.listeners[t]||(this.listeners[t]=[]);var o={once:!1,callback:e,context:i};return this.listeners[t].push(o),o},once:function(t,e,i){if("object"==typeof t){var n={};for(var s in t)n[s]=this.once(s,t[s],i);return n}this.listeners[t]||(this.listeners[t]=[]);var o={once:!0,callback:e,context:i};return this.listeners[t].push(o),o},off:function(t,e){for(var i=0,n=this.listeners[t].length;n>i;i++)this.listeners[t][i]===e&&(this.listeners[t].splice(i--,1),n--)},trigger:function(t,e){if(this.listeners.event)for(var i=0,n=this.listeners.event.length;n>i;i++){var s=this.listeners.event[i];s.callback.call(s.context||this,t,e)}if(this.listeners[t])for(var i=0,n=this.listeners[t].length;n>i;i++){var s=this.listeners[t][i];s.callback.call(s.context||this,e),s.once&&(this.listeners[t].splice(i--,1),n--)}}},PLAYGROUND.States=function(t){this.app=t,PLAYGROUND.Events.call(this),t.on("step",this.step.bind(this))},PLAYGROUND.States.prototype={step:function(t){if(this.next&&(!this.current||!this.current.locked)){var e=this.next;"function"==typeof e&&(e=new e),e.__created||(e.__created=!0,e.app=this.app,this.trigger("createstate",{state:e}),e.create&&e.create()),this.current&&this.trigger("leavestate",{prev:this.current,next:e,state:this.current}),this.trigger("enterstate",{prev:this.current,next:e,state:e}),this.current=e,this.current&&this.current.enter&&this.current.enter(),this.app.state=this.current,this.next=!1}},set:function(t){this.current&&this.current.leave&&this.current.leave(),this.next=t,this.step(0)}},PLAYGROUND.Utils.extend(PLAYGROUND.States.prototype,PLAYGROUND.Events.prototype),PLAYGROUND.Application=function(t){function e(){i.loadFoo(.25),setTimeout(function(){i.emitLocalEvent("create"),i.setState(PLAYGROUND.DefaultState),i.handleResize(),PLAYGROUND.LoadingScreen&&i.setState(PLAYGROUND.LoadingScreen),PLAYGROUND.GameLoop(i),i.loader.once("ready",function(){i.firstBatch=!1,i.disabledUntilLoaded&&(i.skipEvents=!1),i.setState(PLAYGROUND.DefaultState),i.emitLocalEvent("ready"),i.handleResize()})})}var i=this;this.killed=!1,PLAYGROUND.Events.call(this),PLAYGROUND.Utils.merge(this,this.defaults,t),this.autoWidth=!this.width,this.autoHeight=!this.height,this.autoScale=!this.scale,this.container||(this.container=document.body),this.container!==document.body&&(this.customContainer=!0),"string"==typeof this.container&&(this.container=document.querySelector(this.container)),this.updateSize(),this.states=new PLAYGROUND.States(this),this.states.on("event",this.emitLocalEvent,this),this.mouse=new PLAYGROUND.Mouse(this,this.container),this.mouse.on("event",this.emitGlobalEvent,this),this.touch=new PLAYGROUND.Touch(this,this.container),this.touch.on("event",this.emitGlobalEvent,this),this.keyboard=new PLAYGROUND.Keyboard(this),this.keyboard.on("event",this.emitGlobalEvent,this),this.gamepads=new PLAYGROUND.Gamepads(this),this.gamepads.on("event",this.emitGlobalEvent,this),this.tweens=new PLAYGROUND.TweenManager(this),this.ease=PLAYGROUND.Utils.ease,PLAYGROUND.Sound(this),document.addEventListener("visibilitychange",this.handleVisibilityChange.bind(this)),this.resizelistener=PLAYGROUND.Utils.throttle(this.handleResize.bind(this),100),window.addEventListener("resize",this.resizelistener),this.images={},this.atlases={},this.data={},this.loader=new PLAYGROUND.Loader(this),this.loadFoo(.25),this.plugins=[];for(var n in PLAYGROUND){var s=PLAYGROUND[n];s.plugin&&this.plugins.push(new s(this))}this.emitLocalEvent("preload"),this.firstBatch=!0,this.disabledUntilLoaded&&(this.skipEvents=!0),this.loader.once("ready",e)},PLAYGROUND.Application.prototype={defaults:{background:"#272822",smoothing:1,paths:{base:"",images:"images/",fonts:"fonts/"},offsetX:0,offsetY:0,skipEvents:!1,disabledUntilLoaded:!0},setState:function(t){this.states.set(t)},insertAsset:function(t,e,i){for(var n=i.split("/"),s=e,o=0;o<n.length-1;o++){var r=n[o];s[r]||(s[r]={}),s=s[r]}s[n.pop()]=t},getPath:function(t){return this.paths.base+(this.paths[t]||t+"/")},getAssetEntry:function(t,e,i){var e=this.paths[e]||e+"/",n=t.match(/(.*)\..*/),s=n?n[1]:t,o=t.split("."),r=t;if(o.length>1){var a=o.pop();t=o.join(".")}else{var a=i;r+="."+i}return{key:s,url:this.paths.base+e+r,path:this.paths.base+e+t,ext:a}},emitLocalEvent:function(t,e){this.trigger(t,e),"render"===t&&this.skipEvents&&!this.loader.ready||!this[t]||this[t](e)},emitGlobalEvent:function(t,e){return this.state?(this.trigger(t,e),"render"===t&&this.skipEvents&&!this.loader.ready||!this.event||this.event(t,e),"render"===t&&this.skipEvents&&!this.loader.ready||!this[t]||this[t](e),this.state.event&&this.state.event(t,e),this.state[t]&&this.state[t](e),void this.trigger("after"+t,e)):this.emitLocalEvent(t,e)},updateSize:function(){if(this.customContainer)var t=this.container.offsetWidth,e=this.container.offsetHeight;else var t=window.innerWidth,e=window.innerHeight;(this.autoScale||this.autoWidth||this.autoHeight)&&(!this.autoHeight&&this.autoWidth?(this.autoScale&&(this.scale=e/this.height),this.width=Math.ceil(t/this.scale)):!this.autoWidth&&this.autoHeight?(this.autoScale&&(this.scale=t/this.width),this.height=Math.ceil(e/this.scale)):this.autoWidth&&this.autoHeight&&this.autoScale?(this.scale=1,this.width=t,this.height=e):this.autoWidth&&this.autoHeight?(this.width=Math.ceil(t/this.scale),this.height=Math.ceil(e/this.scale)):this.scale=Math.min(t/this.width,e/this.height)),this.offsetX=(t-this.width*this.scale)/2|0,this.offsetY=(e-this.height*this.scale)/2|0,this.center={x:this.width/2|0,y:this.height/2|0}},handleVisibilityChange:function(){this.emitGlobalEvent("visibilitychange",{visible:!document.hidden,hidden:document.hidden})},handleResize:function(){this.emitGlobalEvent("beforeresize",{}),this.updateSize(),this.mouse.handleResize(),this.touch.handleResize(),this.emitGlobalEvent("resize",{})},request:function(t){function e(e,i){var n=new XMLHttpRequest;n.open("GET",t,!0),n.onload=function(n){var s=n.target;return 200!==s.status&&0!==s.status?i(new Error("Failed to get "+t)):void e(s)},n.send()}return new Promise(e)},loadFoo:function(t){var e=this.loader;this.loader.add("foo "+t),setTimeout(function(){e.success("foo "+t)},1e3*t)},loadData:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];if("object"==typeof e)for(var i in e)this.loadData(e[i]);else this.loadDataItem(e)}},loadDataItem:function(t){function e(t){var e=i.key.indexOf("/")>-1;if("json"===i.ext){var s=JSON.parse(t.responseText);if(e){var o=i.key.split("/")[0];n.data[o]||(n.data[o]={}),PLAYGROUND.Utils.extend(n.data[o],s)}else n.data[i.key]||(n.data[i.key]={}),PLAYGROUND.Utils.defaults(n.data[i.key],s)}else if(e){var o=i.key.split("/")[0];n.data[o]||(n.data[o]=""),n.data[i.key]+=t.responseText}else n.data[i.key]=t.responseText;n.loader.success(i.url)}var i=this.getAssetEntry(t,"data","json"),n=this;this.loader.add(),this.request(i.url).then(e)},loadImage:function(){return this.loadImages.apply(this,arguments)},loadImages:function(){for(var t=[],e=0;e<arguments.length;e++){var i=arguments[e];if("object"==typeof i)for(var n in i)t=t.concat(this.loadImages(i[n]));else t.push(this.loadOneImage(i))}return Promise.all(t)},loadOneImage:function(t){var e=this;if(this._imageLoaders||(this._imageLoaders={}),!this._imageLoaders[t]){var i=function(i,n){var s=e.loader,o=e.getAssetEntry(t,"images","png");e.loader.add(o.path);var r=new Image;r.addEventListener("load",function(){e.images[o.key]=r,i(r),s.success(o.url),o.image=r,e.insertAsset(r,e.images,o.key),e.emitLocalEvent("imageready",o)}),r.addEventListener("error",function(){n("can't load "+o.url),s.error(o.url)}),r.src=o.url};e._imageLoaders[t]=new Promise(i)}return this._imageLoaders[t]},loadFont:function(){for(var t=[],e=0;e<arguments.length;e++){var i=arguments[e];t.push(this.loadFontItem(i))}return Promise.all(t)},loadFonts:function(){return this.loadFont.apply(this,arguments)},loadFontItem:function(t){if(!this.fontStyleSheet){var e=document.createElement("style");document.head.appendChild(e),this.fontStyleSheet=e}var i=this.getAssetEntry(t,"fonts","ttf"),n={woff:"woff",otf:"opentype",ttf:"truetype"}[i.ext],s="@font-face { font-family: '{name}'; font-style: 'normal'; font-weight: 400, 800; src: url(fonts/{name}.{ext}) format('{format}'); }",o=PLAYGROUND.Utils.sprintf(s,{name:t,ext:i.ext,format:n});this.fontStyleSheet.innerHTML+=o;var r=this;if(this._fontPromises||(this._fontPromises={}),!this._fontPromises[t]){var a=function(e,i){r.loader.add("font "+t);var n=setInterval(function(){var i=cq(100,32).font("14px somethingrandom").fillStyle("#fff").textBaseline("top");i.context.fillText("lorem ipsum dolores sit",0,4);var s=cq(100,32).font("14px '"+t+"'").fillStyle("#fff").textBaseline("top");s.context.fillText("lorem ipsum dolores sit",0,4),cq.compare(i,s)||(r.loader.success("font"+t),clearInterval(n),e())},100)};this._fontPromises[t]=new Promise(a)}return this._fontPromises[t]},render:function(){},enableInputs:function(){this.mouse.enabled=!0,this.touch.enabled=!0,this.keyboard.enabled=!0},disableInputs:function(){this.mouse.enabled=!1,this.touch.enabled=!1,this.keyboard.enabled=!1},kill:function(){this.killed=!0,this.trigger("kill"),window.removeEventListener("resize",this.resizelistener)}},PLAYGROUND.Utils.extend(PLAYGROUND.Application.prototype,PLAYGROUND.Events.prototype),PLAYGROUND.GameLoop=function(t){function e(e){t.emitGlobalEvent("prerender",e),t.emitGlobalEvent("render",e),t.emitGlobalEvent("postrender",e)}function i(e){t.emitGlobalEvent("step",e)}function n(){if(!t.killed){if(requestAnimationFrame(n),t.frameskip){if(o++,o!==t.frameskip)return;o=0}var r=Date.now()-s;if(s=Date.now(),!(r>1e3)){var a=r/1e3;t.lifetime+=a,t.elapsed=a,i(a),e(a),t.opcost=r/1e3,t.ops=1e3/t.opcost}}}t.lifetime=0,t.ops=0,t.opcost=0;var s=Date.now(),o=0;requestAnimationFrame(n)},PLAYGROUND.Gamepads=function(t){this.app=t,PLAYGROUND.Events.call(this),this.getGamepads=navigator.getGamepads||navigator.webkitGetGamepads,this.gamepadmoveEvent={},this.gamepaddownEvent={},this.gamepadupEvent={},this.gamepadholdEvent={},this.gamepads={},this.app.on("step",this.step.bind(this))},PLAYGROUND.Gamepads.prototype={buttons:{0:"1",1:"2",2:"3",3:"4",4:"l1",5:"r1",6:"l2",7:"r2",8:"select",9:"start",12:"up",13:"down",14:"left",15:"right"},zeroState:function(){for(var t=[],e=0;15>=e;e++)t.push({pressed:!1,value:0});return{axes:[],buttons:t}},createGamepad:function(){for(var t={buttons:{},sticks:[{x:0,y:0},{x:0,y:0}]},e=0;16>e;e++){var i=this.buttons[e];t.buttons[i]=!1}return t},step:function(){if(navigator.getGamepads)for(var t=navigator.getGamepads(),e=0;e<t.length;e++){var i=t[e];if(i){this[e]||(this[e]=this.createGamepad());for(var n=[].concat(i.buttons),s=12;15>=s;s++)n[s]={pressed:!1,value:0};var o=this[e];if(i.axes){Math.abs(i.axes[0])>.01&&(i.axes[0]<0&&(n[14].pressed=!0),i.axes[0]>0&&(n[15].pressed=!0)),Math.abs(i.axes[1])>.01&&(i.axes[1]<0&&(n[12].pressed=!0),i.axes[1]>0&&(n[13].pressed=!0));var r=!1,a=!1,h=!1;o.sticks[0].x!==i.axes[0]&&(r=!0,a=!0),o.sticks[0].y!==i.axes[1]&&(r=!0,a=!0),o.sticks[1].x!==i.axes[2]&&(r=!0,h=!0),o.sticks[1].y!==i.axes[3]&&(r=!0,h=!0),r&&(this.gamepadmoveEvent.old=[PLAYGROUND.Utils.extend({},o.sticks[0]),PLAYGROUND.Utils.extend({},o.sticks[1])],o.sticks[0].x=i.axes[0],o.sticks[0].y=i.axes[1],o.sticks[1].x=i.axes[2],o.sticks[1].y=i.axes[3],this.gamepadmoveEvent.sticks=o.sticks,a?this.gamepadmoveEvent.a=o.sticks[0]:this.gamepadmoveEvent.a=!1,h?this.gamepadmoveEvent.b=o.sticks[1]:this.gamepadmoveEvent.b=!1,this.gamepadmoveEvent.gamepad=e,this.trigger("gamepadmove",this.gamepadmoveEvent))}for(var u=0;u<n.length;u++){var l=this.buttons[u];n[u].pressed&&!o.buttons[l]&&(o.buttons[l]=!0,this.gamepaddownEvent.button=this.buttons[u],this.gamepaddownEvent.gamepad=e,this.trigger("gamepaddown",this.gamepaddownEvent)),n[u].pressed?(this.gamepadholdEvent.button=this.buttons[u],this.gamepadholdEvent.gamepad=e,this.gamepadholdEvent.dt=this.app.elapsed,this.trigger("gamepadhold",this.gamepadholdEvent)):!n[u].pressed&&o.buttons[l]&&(o.buttons[l]=!1,this.gamepadupEvent.button=this.buttons[u],this.gamepadupEvent.gamepad=e,this.trigger("gamepadup",this.gamepadupEvent))}}}}},PLAYGROUND.Utils.extend(PLAYGROUND.Gamepads.prototype,PLAYGROUND.Events.prototype),PLAYGROUND.Keyboard=function(t){PLAYGROUND.Events.call(this),this.app=t,this.keys={},this.any=!1,this.keydownlistener=this.keydown.bind(this),this.keyuplistener=this.keyup.bind(this),this.keypresslistener=this.keypress.bind(this),document.addEventListener("keydown",this.keydownlistener),document.addEventListener("keyup",this.keyuplistener),document.addEventListener("keypress",this.keypresslistener),this.keydownEvent={},this.keyupEvent={},this.keypressEvent={},this.preventDefault=!0,this.enabled=!0,this.app.on("kill",this.kill.bind(this))},PLAYGROUND.Keyboard.prototype={kill:function(){document.removeEventListener("keydown",this.keydownlistener),document.removeEventListener("keyup",this.keyuplistener),document.removeEventListener("keypress",this.keypresslistener)},keycodes:{37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",96:"numpad0",97:"numpad1",98:"numpad2",99:"numpad3",100:"numpad4",101:"numpad5",102:"numpad6",103:"numpad7",104:"numpad8",105:"numpad9",106:"numpadmul",107:"numpadadd",109:"numpadsub",110:"numpaddec",111:"numpaddiv",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:"semicolon",187:"equal",188:"comma",189:"dash",190:"period",191:"slash",192:"graveaccent",219:"openbracket",220:"backslash",221:"closebraket",222:"singlequote"},bypassKeys:["f12","f11","f5","ctrl","alt","shift"],keydown:function(t){if(this.enabled){if(t.which>=48&&t.which<=90)var e=String.fromCharCode(t.which).toLowerCase();else var e=this.keycodes[t.which];if(!this.keys[e]&&(this.any++,this.keydownEvent.key=e,this.keydownEvent.original=t,this.keys[e]=!0,this.trigger("keydown",this.keydownEvent),this.preventDefault&&document.activeElement===document.body)){var i=t.metaKey;if(!i)for(var n=0;n<this.bypassKeys.length;n++)if(this.keys[this.bypassKeys[n]]){i=!0;break}i||(t.preventDefault(),t.stopPropagation())}}},keyup:function(t){if(this.enabled){if(t.which>=48&&t.which<=90)var e=String.fromCharCode(t.which).toLowerCase();else var e=this.keycodes[t.which];this.any--,this.keyupEvent.key=e,this.keyupEvent.original=t,this.keys[e]=!1,this.trigger("keyup",this.keyupEvent)}},keypress:function(t){if(this.enabled){if(t.which>=48&&t.which<=90)var e=String.fromCharCode(t.which).toLowerCase();else var e=this.keycodes[t.which];this.keypressEvent.key=e,this.keypressEvent.original=t,this.trigger("keypress",this.keypressEvent)}}},PLAYGROUND.Utils.extend(PLAYGROUND.Keyboard.prototype,PLAYGROUND.Events.prototype),PLAYGROUND.Pointer=function(t){this.app=t,t.on("touchstart",this.touchstart,this),t.on("touchend",this.touchend,this),t.on("touchmove",this.touchmove,this),t.on("mousemove",this.mousemove,this),t.on("mousedown",this.mousedown,this),t.on("mouseup",this.mouseup,this),t.on("mousewheel",this.mousewheel,this),this.pointers=t.pointers={},this.lastTap=0},PLAYGROUND.Pointer.plugin=!0,PLAYGROUND.Pointer.prototype={updatePointer:function(t){this.pointers[t.id]||(this.pointers[t.id]={});var e=this.pointers[t.id];return e.x=t.x,e.y=t.y,e.id=t.id,e},removePointer:function(t){delete this.pointers[t.id]},touchstart:function(t){t.touch=!0,this.updatePointer(t),this.pointerdown(t),this.app.emitGlobalEvent("pointerdown",t)},touchend:function(t){t.touch=!0,this.pointerup(t),this.removePointer(t),this.app.emitGlobalEvent("pointerup",t)},touchmove:function(t){t.touch=!0,this.updatePointer(t),this.pointermove(t),this.app.emitGlobalEvent("pointermove",t)},mousemove:function(t){t.mouse=!0,this.updatePointer(t),this.pointermove(t),this.app.emitGlobalEvent("pointermove",t)},mousedown:function(t){t.mouse=!0,this.updatePointer(t),this.app.emitGlobalEvent("pointerdown",t),this.pointerdown(t)},mouseup:function(t){t.mouse=!0,this.pointerup(t),this.app.emitGlobalEvent("pointerup",t)},mousewheel:function(t){t.mouse=!0,this.app.emitGlobalEvent("pointerwheel",t)},pointerdown:function(t){var e=this.pointers[t.id];e.pressed=!0;var i=this.app.lifetime-e.lastTap;e.lastTap=this.app.lifetime,.4>i&&e.tapPosition&&PLAYGROUND.Utils.distance(e,e.tapPosition)<5&&(this.app.emitGlobalEvent("pointerdoubletap",e),e.lastTap=0),e.tapPosition={x:t.x,y:t.y}},pointermove:function(t){var e=this.pointers[t.id];!e.dragging&&e.pressed&&PLAYGROUND.Utils.distance(e.tapPosition,t)>5&&(e.dragging=!0),t.dragging=e.dragging},pointerup:function(t){var e=this.pointers[t.id];e.pressed=!1,e.dragging=!1}},PLAYGROUND.Loader=function(t){this.app=t,PLAYGROUND.Events.call(this),this.reset()},PLAYGROUND.Loader.prototype={add:function(t){return this.queue++,this.count++,this.ready=!1,this.trigger("add",t),t},error:function(t){this.trigger("error",t)},success:function(t){this.queue--,this.progress=1-this.queue/this.count,this.trigger("load",t),this.queue<=0&&(this.reset(),this.trigger("ready"))},reset:function(){this.progress=0,this.queue=0,this.count=0,this.ready=!0}},PLAYGROUND.Utils.extend(PLAYGROUND.Loader.prototype,PLAYGROUND.Events.prototype),PLAYGROUND.Mouse=function(t,e){var i=this;this.app=t,PLAYGROUND.Events.call(this),this.element=e,this.preventContextMenu=!0,this.enabled=!0,this.mousemoveEvent={},this.mousedownEvent={},this.mouseupEvent={},this.mousewheelEvent={},this.x=0,this.y=0,this.mousemovelistener=this.mousemove.bind(this),this.mousedownlistener=this.mousedown.bind(this),this.mouseuplistener=this.mouseup.bind(this),this.mouseoutlistener=this.mouseout.bind(this),this.contextmenulistener=function(t){i.preventContextMenu&&!t.metaKey&&t.preventDefault()},e.addEventListener("mousemove",this.mousemovelistener),e.addEventListener("mousedown",this.mousedownlistener),e.addEventListener("mouseup",this.mouseuplistener),e.addEventListener("mouseout",this.mouseoutlistener),e.addEventListener("contextmenu",this.contextmenulistener),this.app.on("kill",this.kill.bind(this)),this.enableMousewheel(),e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,this.handleResize()},PLAYGROUND.Mouse.prototype={kill:function(){this.element.removeEventListener("mousemove",this.mousemovelistener),this.element.removeEventListener("mousedown",this.mousedownlistener),this.element.removeEventListener("mouseup",this.mouseuplistener),this.element.removeEventListener("mouseout",this.mouseoutlistener),this.element.removeEventListener("contextmenu",this.contextmenulistener)},mouseout:function(t){for(var e=0;3>e;e++)this.mouseup({button:e})},lock:function(){this.locked=!0,this.element.requestPointerLock()},unlock:function(){this.locked=!1,document.exitPointerLock()},getElementOffset:function(t){var e=0,i=0;do e+=t.offsetLeft,i+=t.offsetTop;while(t=t.offsetParent);return{x:e,y:i}},handleResize:function(){this.elementOffset=this.getElementOffset(this.element)},mousemove:PLAYGROUND.Utils.throttle(function(t){this.enabled&&(this.x=this.mousemoveEvent.x=(t.pageX-this.elementOffset.x-this.app.offsetX)/this.app.scale|0,this.y=this.mousemoveEvent.y=(t.pageY-this.elementOffset.y-this.app.offsetY)/this.app.scale|0,this.mousemoveEvent.original=t,this.locked&&(this.mousemoveEvent.movementX=t.movementX||t.mozMovementX||t.webkitMovementX||0,this.mousemoveEvent.movementY=t.movementY||t.mozMovementY||t.webkitMovementY||0),this.app.mouseToTouch?(this.mousemoveEvent.id=this.mousemoveEvent.identifier=255,this.trigger("touchmove",this.mousemoveEvent)):(this.mousemoveEvent.id=this.mousemoveEvent.identifier=255,this.trigger("mousemove",this.mousemoveEvent)))},15),mousedown:function(t){if(this.enabled){var e=["left","middle","right"][t.button];this.mousedownEvent.x=this.mousemoveEvent.x,this.mousedownEvent.y=this.mousemoveEvent.y,this.mousedownEvent.button=e,this.mousedownEvent.original=t,this[e]=!0,this.mousedownEvent.id=this.mousedownEvent.identifier=255,this.app.mouseToTouch?(this.trigger("touchmove",this.mousedownEvent),this.trigger("touchstart",this.mousedownEvent)):this.trigger("mousedown",this.mousedownEvent)}},mouseup:function(t){if(this.enabled){var e=["left","middle","right"][t.button];this[e]&&(this.mouseupEvent.x=this.mousemoveEvent.x,this.mouseupEvent.y=this.mousemoveEvent.y,this.mouseupEvent.button=e,this.mouseupEvent.original=t,this.mouseupEvent.id=this.mouseupEvent.identifier=255,this.app.mouseToTouch?this.trigger("touchend",this.mouseupEvent):this.trigger("mouseup",this.mouseupEvent),this[e]=!1)}},mousewheel:function(t){this.mousewheelEvent.x=this.mousemoveEvent.x,this.mousewheelEvent.y=this.mousemoveEvent.y,this.mousewheelEvent.button=["none","left","middle","right"][t.button],this.mousewheelEvent.original=t,this.mousewheelEvent.id=this.mousewheelEvent.identifier=255,this[t.button]=!1,this.trigger("mousewheel",this.mousewheelEvent)},enableMousewheel:function(){for(var t=("onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"]),e=this.mousewheel.bind(this),i=this,n=PLAYGROUND.Utils.throttle(function(t){var n=t||window.event,s=([].slice.call(arguments,1),0),o=0;n.wheelDelta&&(s=n.wheelDelta),n.detail&&(s=-1*n.detail),n.deltaY&&(o=-1*n.deltaY,s=o),void 0!==n.wheelDeltaY&&(o=n.wheelDeltaY);var r=s?s:o;i.mousewheelEvent.x=i.mousemoveEvent.x,i.mousewheelEvent.y=i.mousemoveEvent.y,i.mousewheelEvent.delta=r/Math.abs(r),i.mousewheelEvent.original=n,e(i.mousewheelEvent),n.preventDefault()},40),s=t.length;s;)i.element.addEventListener(t[--s],function(t){n(t),t.preventDefault(),t.stopPropagation()},!1)}},PLAYGROUND.Utils.extend(PLAYGROUND.Mouse.prototype,PLAYGROUND.Events.prototype),PLAYGROUND.Sound=function(t){var e=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;e&&!t.forceAudioFallback?(PLAYGROUND.audioContext||(PLAYGROUND.audioContext=new e),t.audioContext=PLAYGROUND.audioContext,t.sound=new PLAYGROUND.SoundWebAudioAPI(t,t.audioContext),t.music=new PLAYGROUND.SoundWebAudioAPI(t,t.audioContext)):(t.sound=new PLAYGROUND.SoundAudio(t),t.music=new PLAYGROUND.SoundAudio(t))},PLAYGROUND.Application.prototype.playSound=function(t,e){return this.sound.play(t,e)},PLAYGROUND.Application.prototype.stopSound=function(t){this.sound.stop(t)},PLAYGROUND.Application.prototype.loadSound=function(){return this.loadSounds.apply(this,arguments)},PLAYGROUND.Application.prototype.loadSounds=function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];if("object"==typeof e)for(var i in e)this.loadSounds(e[i]);else this.sound.load(e)}},function t(e,i,n){function s(r,a){if(!i[r]){if(!e[r]){var h="function"==typeof require&&require;if(!a&&h)return h(r,!0);if(o)return o(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var l=i[r]={exports:{}};e[r][0].call(l.exports,function(t){var i=e[r][1][t];return s(i?i:t)},l,l.exports,t,e,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(t,e,i){(function(e){"use strict";var i=e.AudioContext||e.webkitAudioContext,n=t("stereo-panner-node");i&&!i.prototype.createStereoPanner&&(i.prototype.createStereoPanner=function(){return new n(this)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"stereo-panner-node":4}],2:[function(t,e,i){"use strict";var n=4096,s=new Float32Array(n),o=new Float32Array(n);!function(){for(var t=0;n>t;t++)s[t]=Math.cos(t/n*Math.PI*.5),o[t]=Math.sin(t/n*Math.PI*.5)}(),e.exports={L:s,R:o}},{}],3:[function(t,e,i){(function(i){"use strict";function n(t){this.audioContext=t,this.inlet=t.createChannelSplitter(2),this._pan=t.createGain(),this.pan=this._pan.gain,this._wsL=t.createWaveShaper(),this._wsR=t.createWaveShaper(),this._L=t.createGain(),this._R=t.createGain(),this.outlet=t.createChannelMerger(2),this.inlet.channelCount=2,this.inlet.channelCountMode="explicit",this._pan.gain.value=0,this._wsL.curve=s.L,this._wsR.curve=s.R,this._L.gain.value=0,this._R.gain.value=0,this.inlet.connect(this._L,0),this.inlet.connect(this._R,1),this._L.connect(this.outlet,0,0),this._R.connect(this.outlet,0,1),this._pan.connect(this._wsL),this._pan.connect(this._wsR),this._wsL.connect(this._L.gain),this._wsR.connect(this._R.gain),this._isConnected=!1,this._dc1buffer=null,this._dc1=null}var s=t("./curve");n.prototype.connect=function(t){var e=this.audioContext;this._isConnected||(this._isConnected=!0,this._dc1buffer=e.createBuffer(1,2,e.sampleRate),this._dc1buffer.getChannelData(0).set([1,1]),this._dc1=e.createBufferSource(),this._dc1.buffer=this._dc1buffer,this._dc1.loop=!0,this._dc1.start(e.currentTime),
this._dc1.connect(this._pan)),i.AudioNode.prototype.connect.call(this.outlet,t)},n.prototype.disconnect=function(){var t=this.audioContext;this._isConnected&&(this._isConnected=!1,this._dc1.stop(t.currentTime),this._dc1.disconnect(),this._dc1=null,this._dc1buffer=null),i.AudioNode.prototype.disconnect.call(this.outlet)},e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./curve":2}],4:[function(t,e,i){"use strict";function n(t){var e=new s(t);return Object.defineProperties(e.inlet,{pan:{value:e.pan,enumerable:!0},connect:{value:function(t){return e.connect(t)}},disconnect:{value:function(){return e.disconnect()}}}),e.inlet}var s=t("./stereo-panner-impl");e.exports=n},{"./stereo-panner-impl":3}]},{},[1]),PLAYGROUND.SoundWebAudioAPI=function(t,e){this.app=t;var i=(new Audio).canPlayType("audio/mp3"),n=(new Audio).canPlayType('audio/ogg; codecs="vorbis"');"mp3"===this.app.preferedAudioFormat?i?this.audioFormat="mp3":this.audioFormat="ogg":n?this.audioFormat="ogg":this.audioFormat="mp3",this.context=e,this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination),this.compressor=this.context.createDynamicsCompressor(),this.compressor.connect(this.gainNode),this.output=this.compressor,this.gainNode.gain.value=1,this.pool=[],this.volume=1,this.loops=[],this.app.on("step",this.step.bind(this))},PLAYGROUND.SoundWebAudioAPI.prototype={buffers:{},aliases:{},alias:function(t,e,i,n){this.aliases[t]={source:e,volume:i,rate:n}},setMaster:function(t){this.volume=t,this.gainNode.gain.value=t},load:function(t){var e=this.app.getAssetEntry(t,"sounds",this.audioFormat),i=this,n=new XMLHttpRequest;n.open("GET",e.url,!0),n.responseType="arraybuffer";this.app.loader.add(e.url);n.onload=function(){i.context.decodeAudioData(this.response,function(t){i.buffers[e.key]=t,i.app.loader.success(e.url)})},n.send()},cleanArray:function(t,e){for(var i=0,n=t.length;n>i;i++)(null===t[i]||e&&t[i][e])&&(t.splice(i--,1),n--)},getSoundBuffer:function(){if(!this.pool.length)for(var t=0;100>t;t++){var e,i,n,s=[e=this.context.createBufferSource(),i=this.context.createGain(),n=this.context.createStereoPanner()];this.pool.push(s),PLAYGROUND.MOBILE?(s[0].connect(s[1]),s[1].connect(this.gainNode)):(s[0].connect(s[1]),s[1].connect(s[2]),s[2].connect(this.output))}return this.pool.pop()},play:function(t,e){var i=this.aliases[t],n=this.getSoundBuffer();return i&&(t=i.source),bufferSource=n[0],bufferSource.gainNode=n[1],bufferSource.pannerNode=n[2],bufferSource.buffer=this.buffers[t],bufferSource.loop=e||!1,bufferSource.key=t,bufferSource.alias=i,this.setVolume(bufferSource,1),this.setPlaybackRate(bufferSource,1),this.loop,bufferSource.start(0),bufferSource.volumeLimit=1,bufferSource},stop:function(t){t&&t.stop(0)},setPlaybackRate:function(t,e){return t?(t.alias&&(e*=t.alias.rate),t.playbackRate.value=e):void 0},getVolume:function(t){return t?t.gainNode.gain.value:void 0},setVolume:function(t,e){return t?(t.alias&&(e*=t.alias.volume),t.gainNode.gain.value=Math.max(0,e)):void 0},setPanning:function(t,e){t.pannerNode.pan.value=e},getPanning:function(t){return t.pannerNode.pan.value},fadeOut:function(t){return t?(t.fadeOut=!0,this.loops.push(t),t):void 0},fadeIn:function(t){return t?(t.fadeIn=!0,this.loops.push(t),this.setVolume(t,0),t):void 0},step:function(t){for(var e=0;e<this.loops.length;e++){var i=this.loops[e];if(i.fadeIn){var n=this.getVolume(i);n=this.setVolume(i,Math.min(1,n+.5*t)),n>=1&&this.loops.splice(e--,1)}if(i.fadeOut){var n=this.getVolume(i);n=this.setVolume(i,Math.min(1,n-.5*t)),0>=n&&(this.loops.splice(e--,1),this.stop(i))}}}},PLAYGROUND.SoundAudio=function(t){this.app=t;var e=(new Audio).canPlayType("audio/mp3"),i=(new Audio).canPlayType('audio/ogg; codecs="vorbis"');"mp3"===this.app.preferedAudioFormat?e?this.audioFormat="mp3":this.audioFormat="ogg":i?this.audioFormat="ogg":this.audioFormat="mp3"},PLAYGROUND.SoundAudio.prototype={samples:{},setMaster:function(t){this.volume=t},setMasterPosition:function(){},setPosition:function(t,e,i){},load:function(t){console.log(t,this.audioFormat);var e="sounds/"+t+"."+this.audioFormat,i=this.app.loader;this.app.loader.add(e);var n=this.samples[t]=new Audio;n.addEventListener("canplay",function(){console.log("CANPLAY"),this.pause(),i.success(e)}),n.addEventListener("error",function(){i.error(e)}),n.src=e,n.play()},play:function(t,e){var i=this.samples[t];return i.currentTime=0,i.loop=e,i.play(),i},stop:function(t){t&&t.pause()},step:function(t){},setPlaybackRate:function(t,e){},setVolume:function(t,e){t.volume=e*this.volume},setPosition:function(){},setPanning:function(t,e){}},PLAYGROUND.Touch=function(t,e){PLAYGROUND.Events.call(this),this.app=t,this.element=e,this.touches={},this.enabled=!0,this.x=0,this.y=0,this.touchmovelistener=this.touchmove.bind(this),this.touchstartlistener=this.touchstart.bind(this),this.touchendlistener=this.touchend.bind(this),e.addEventListener("touchmove",this.touchmovelistener),e.addEventListener("touchstart",this.touchstartlistener),e.addEventListener("touchend",this.touchendlistener),this.app.on("kill",this.kill.bind(this))},PLAYGROUND.Touch.prototype={kill:function(){this.element.removeEventListener("touchmove",this.touchmovelistener),this.element.removeEventListener("touchstart",this.touchstartlistener),this.element.removeEventListener("touchend",this.touchendlistener)},getElementOffset:function(t){var e=0,i=0;do e+=t.offsetLeft,i+=t.offsetTop;while(t=t.offsetParent);return{x:e,y:i}},handleResize:function(){this.elementOffset=this.getElementOffset(this.element)},touchmove:function(t){if(this.enabled){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e];touchmoveEvent={},this.x=touchmoveEvent.x=(i.pageX-this.elementOffset.x-this.app.offsetX)/this.app.scale|0,this.y=touchmoveEvent.y=(i.pageY-this.elementOffset.y-this.app.offsetY)/this.app.scale|0,touchmoveEvent.original=i,touchmoveEvent.id=touchmoveEvent.identifier=i.identifier,this.touches[i.identifier].x=touchmoveEvent.x,this.touches[i.identifier].y=touchmoveEvent.y,this.trigger("touchmove",touchmoveEvent)}t.preventDefault()}},touchstart:function(t){if(this.enabled){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],n={};this.x=n.x=(i.pageX-this.elementOffset.x-this.app.offsetX)/this.app.scale|0,this.y=n.y=(i.pageY-this.elementOffset.y-this.app.offsetY)/this.app.scale|0,n.original=t.touch,n.id=n.identifier=i.identifier,this.touches[i.identifier]={x:n.x,y:n.y},this.trigger("touchstart",n)}t.preventDefault()}},touchend:function(t){if(this.enabled){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],n={};n.x=(i.pageX-this.elementOffset.x-this.app.offsetX)/this.app.scale|0,n.y=(i.pageY-this.elementOffset.y-this.app.offsetY)/this.app.scale|0,n.original=i,n.id=n.identifier=i.identifier,delete this.touches[i.identifier],this.trigger("touchend",n)}t.preventDefault()}}},PLAYGROUND.Utils.extend(PLAYGROUND.Touch.prototype,PLAYGROUND.Events.prototype),PLAYGROUND.Tween=function(t,e){PLAYGROUND.Events.call(this),this.manager=t,this.context=e,PLAYGROUND.Utils.extend(this,{prevEasing:"045",prevDuration:.5}),this.clear()},PLAYGROUND.Tween.prototype={add:function(t,e,i){return"undefined"!=typeof e?this.prevDuration=e:e=.5,i?this.prevEasing=i:i="045",this.actions.push([t,e,i]),this},clear:function(){return this.actions=[],this.index=-1,this.current=!1,this},discard:function(){return this.manager.discard(this.context,this),this},to:function(t,e,i){return this.add(t,e,i)},call:function(t,e){for(var i=["call",t,e||this.context],n=2;n<arguments.length;n++)i.push(arguments[n]);return this.actions.push(i),this},loop:function(){return this.looped=!0,this},repeat:function(t){return this.actions.push(["repeat",t]),this},wait:function(t){return this.actions.push(["wait",t]),this},delay:function(t){return this.actions.push(["wait",t]),this},stop:function(){return this.manager.remove(this),this},play:function(){return this.manager.add(this),this.finished=!1,this},end:function(){for(var t=0,e=this.index+1;e<this.actions.length;e++)"object"==typeof this.actions[e][0]&&(t=e);return this.index=t-1,this.next(),this.delta=this.duration,this.step(0),this},forward:function(){this.delta=this.duration,this.step(0)},rewind:function(){this.delta=0,this.step(0)},next:function(){if(this.delta=0,this.index++,this.index>=this.actions.length){if(!this.looped)return void this.manager.remove(this);this.trigger("loop",{tween:this}),this.index=0}if(this.current=this.actions[this.index],"call"===this.current[0]){var t=this.current.slice(2),e=this.current[1],i=this.current[2],n=i[e];n.apply(i,t)}else if("wait"===this.current[0])this.duration=this.current[1],this.currentAction="wait";else{var s=this.current[0];this.keys=Object.keys(s),this.change=[],this.before=[],this.types=[];for(var o=0;o<this.keys.length;o++){var r=this.keys[o],a=this.context[r];if("number"==typeof s[r])a=a||0,this.before.push(a),this.change.push(s[r]-a),this.types.push(0);else if("string"==typeof s[r]&&s[r].indexOf("rad")>-1)a=a||0,this.before.push(a),this.change.push(PLAYGROUND.Utils.circWrappedDistance(a,parseFloat(s[r]))),this.types.push(2);else{a=a||"#000";var h=cq.color(a);this.before.push(h);for(var u=cq.color(s[r]),l=[],c=0;3>c;c++)l.push(u[c]-h[c]);this.change.push(l),this.types.push(1)}}this.currentAction="animate",this.duration=this.current[1],this.easing=this.current[2]}},prev:function(){},step:function(t){switch(this.delta+=t,this.current||this.next(),this.currentAction){case"animate":this.doAnimate(t);break;case"wait":this.doWait(t)}},doAnimate:function(t){this.progress=this.duration?Math.min(1,this.delta/this.duration):1;for(var e=PLAYGROUND.Utils.ease(this.progress,this.easing),i=0;i<this.keys.length;i++){var n=this.keys[i];switch(this.types[i]){case 0:this.context[n]=this.before[i]+this.change[i]*e;break;case 1:for(var s=this.change[i],o=this.before[i],r=[],a=0;3>a;a++)r.push(o[a]+s[a]*e|0);this.context[n]="rgb("+r.join(",")+")";break;case 2:this.context[n]=PLAYGROUND.Utils.circWrap(this.before[i]+this.change[i]*e)}}this.progress>=1&&this.next(),this.listeners.step&&this.trigger("step",{tween:this,dt:t})},doWait:function(t){this.delta>=this.duration&&this.next()},onremove:function(){this.trigger("finished",{tween:this}),this.trigger("finish",{tween:this}),this.finished=!0}},PLAYGROUND.Utils.extend(PLAYGROUND.Tween.prototype,PLAYGROUND.Events.prototype),PLAYGROUND.TweenManager=function(t){this.tweens=[],t&&(this.app=t,this.app.tween=this.tween.bind(this)),this.delta=0,this.app.on("step",this.step.bind(this))},PLAYGROUND.TweenManager.prototype={defaultEasing:"128",circ:function(t){return{type:"circ",value:t}},discard:function(t,e){for(var i=0;i<this.tweens.length;i++){var n=this.tweens[i];n.context===t&&n!==e&&this.remove(n)}},tween:function(t){var e=new PLAYGROUND.Tween(this,t);return this.add(e),e},step:function(t){this.delta+=t;for(var e=0;e<this.tweens.length;e++){var i=this.tweens[e];i._remove||i.step(t),i._remove&&this.tweens.splice(e--,1)}},add:function(t){t._remove=!1;var e=this.tweens.indexOf(t);-1===e&&this.tweens.push(t)},remove:function(t){t._remove||(t._remove=!0,t.onremove())}},PLAYGROUND.Application.prototype.loadAtlases=function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];if("object"==typeof e)for(var i in e)this.loadAtlases(e[i]);else this._loadAtlas(e)}},PLAYGROUND.Application.prototype.loadAtlas=function(){return this.loadAtlases.apply(this,arguments)},PLAYGROUND.Application.prototype._loadAtlas=function(t){var e=this.getAssetEntry(t,"atlases","png");this.loader.add(e.url);var i=this.atlases[e.key]={},n=i.image=new Image;n.addEventListener("load",function(){o.success(e.url)}),n.addEventListener("error",function(){o.error(e.url)}),n.src=e.url;var s=new XMLHttpRequest;s.open("GET",e.path+".json",!0),this.loader.add(e.path+".json");var o=this.loader;s.onload=function(){var t=JSON.parse(this.response);i.frames=[];for(var n=0;n<t.frames.length;n++){var s=t.frames[n];i.frames.push({region:[s.frame.x,s.frame.y,s.frame.w,s.frame.h],offset:[s.spriteSourceSize.x||0,s.spriteSourceSize.y||0],width:s.sourceSize.w,height:s.sourceSize.h})}o.success(e.path+".json")},s.send()},PLAYGROUND.Application.prototype.loadFontOld=function(t){function e(){var i=cq(32,32);i.font("10px "+t).fillText(16,16,16),i.trim(),i.width!==h||i.height!==u?l.loader.ready("font "+t):setTimeout(e,250)}var i=document.createElement("style");i.type="text/css";var n={woff:"woff",ttf:"truetype"},s="";for(var o in n){var r=n[o];s+=' url("fonts/'+t+"."+o+"\") format('"+r+"');"}i.textContent="@font-face { font-family: '"+t+"'; src: "+s+" }",document.head.appendChild(i);var a=cq(32,32);a.font("10px Testing"),a.fillText(16,16,16).trim();var h=a.width,u=a.height;this.loader.add("font "+t);var l=this;e()},PLAYGROUND.DefaultState={},PLAYGROUND.LoadingScreen={logoRaw:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANoAAAASBAMAAADPiN0xAAAAGFBMVEUAAQAtLixHSUdnaGaJioimqKXMzsv7/fr5shgVAAAAAWJLR0QAiAUdSAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB98EAwkeA4oQWJ4AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAB9klEQVQ4y72UvW+rMBDAz+FrpVKrrFmesmapWNOlrKjSe1kZ+uoVAvj+/frujG1SaJcqJwU7voOf7xMQzQmsIDi5NPTMsLRntH3U+F6SAZo3NlCvcgBFJz8o+vkDiE63lI95Y/UmpinsZWkgJWJiDbAVQ16htptxSTNloIlugwaw001Ey3ASF3so6L1qLNXzQS5S0UGKL/CI5wWNriE0UH9Yty37LqIVg+wsqu7Ix0MwVBSF/dU+jv2SNnma021LEdPqVnMeU3xAu0kXcSGjmq7Ox4E2Wn88LZ2+EFj3avjixzai6VPVyuYveZLHF2XfdDnvAq27DIHGuq+0DJFsE30OtB1KqOwd8Dr7PcM4b+jfj2g5lp4WyntBK66qua3JzEA+uXJpwH/NlVuzRVPY/kTLB2mjuN+KwdZ8FOy8j2gDbEUSqumnSCY4lf4ibq3IhVM4ycZQRnv+zFqVdJQVn6BxvUqebGpuaNo3sZxwBzjajiMZOoBiwyVF+kCr+nUaJOaGpnAeRPPJZTr4FqmHRXcneEo4DqQ/ftfdnLeDrUAME8xWKPeKCwW6YkEpXfs3p1EWJhdcUAYP0TI/uYaV8cgjwBovaeyWwji2T9rTFIdS/cP/MnkTLRUWxgNNZVin7bT5fqT9miDcUVJzR1gRpfIONMmulU+5Qqr6zXAUqAAAAABJRU5ErkJggg==",create:function(){var t=this;this.logo=new Image,this.logo.addEventListener("load",function(){t.ready=!0,t.createElements()}),this.logo.src=this.logoRaw,this.background="#000",window.getComputedStyle&&(this.background=window.getComputedStyle(document.body).backgroundColor||"#000")},enter:function(){this.current=0},leave:function(){this.locked=!0,this.animation=this.app.tween(this).to({current:1},.5)},step:function(t){this.locked?this.animation.finished&&(this.locked=!1):this.current=this.current+Math.abs(this.app.loader.progress-this.current)*t},createElements:function(){this.width=.6*window.innerWidth|0,this.height=.1*window.innerHeight|0,this.wrapper=document.createElement("div"),this.wrapper.style.width=this.width+"px",this.wrapper.style.height=this.height+"px",this.wrapper.style.background="#000",this.wrapper.style.border="4px solid #fff",this.wrapper.style.position="absolute",this.wrapper.style.left=(window.innerWidth/2-this.width/2|0)+"px",this.wrapper.style.top=(window.innerHeight/2-this.height/2|0)+"px",this.wrapper.style.zIndex=100,this.progressBar=document.createElement("div"),this.progressBar.style.width="0%",this.progressBar.style.height=this.height+"px",this.progressBar.style.background="#fff"},render:function(){this.ready&&(this.progressBar.style.width=(100*this.current|0)+"%")}};var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var t=/\blang(?:uage)?-(\w+)\b/i,e=0,i=_self.Prism={util:{encode:function(t){return t instanceof n?new n(t.type,i.util.encode(t.content),t.alias):"Array"===i.util.type(t)?t.map(i.util.encode):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(t){return Object.prototype.toString.call(t).match(/\[object (\w+)\]/)[1]},objId:function(t){return t.__id||Object.defineProperty(t,"__id",{value:++e}),t.__id},clone:function(t){var e=i.util.type(t);switch(e){case"Object":var n={};for(var s in t)t.hasOwnProperty(s)&&(n[s]=i.util.clone(t[s]));return n;case"Array":return t.map&&t.map(function(t){return i.util.clone(t)})}return t}},languages:{extend:function(t,e){var n=i.util.clone(i.languages[t]);for(var s in e)n[s]=e[s];return n},insertBefore:function(t,e,n,s){s=s||i.languages;var o=s[t];if(2==arguments.length){n=arguments[1];for(var r in n)n.hasOwnProperty(r)&&(o[r]=n[r]);return o}var a={};for(var h in o)if(o.hasOwnProperty(h)){if(h==e)for(var r in n)n.hasOwnProperty(r)&&(a[r]=n[r]);a[h]=o[h]}return i.languages.DFS(i.languages,function(e,i){i===s[t]&&e!=t&&(this[e]=a)}),s[t]=a},DFS:function(t,e,n,s){s=s||{};for(var o in t)t.hasOwnProperty(o)&&(e.call(t,o,t[o],n||o),"Object"!==i.util.type(t[o])||s[i.util.objId(t[o])]?"Array"!==i.util.type(t[o])||s[i.util.objId(t[o])]||(s[i.util.objId(t[o])]=!0,i.languages.DFS(t[o],e,o,s)):(s[i.util.objId(t[o])]=!0,i.languages.DFS(t[o],e,null,s)))}},plugins:{},highlightAll:function(t,e){var n={callback:e,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};i.hooks.run("before-highlightall",n);for(var s,o=n.elements||document.querySelectorAll(n.selector),r=0;s=o[r++];)i.highlightElement(s,t===!0,n.callback)},highlightElement:function(e,n,s){for(var o,r,a=e;a&&!t.test(a.className);)a=a.parentNode;a&&(o=(a.className.match(t)||[,""])[1].toLowerCase(),r=i.languages[o]),e.className=e.className.replace(t,"").replace(/\s+/g," ")+" language-"+o,a=e.parentNode,/pre/i.test(a.nodeName)&&(a.className=a.className.replace(t,"").replace(/\s+/g," ")+" language-"+o);var h=e.textContent,u={element:e,language:o,grammar:r,code:h};if(i.hooks.run("before-sanity-check",u),!u.code||!u.grammar)return void i.hooks.run("complete",u);if(i.hooks.run("before-highlight",u),n&&_self.Worker){var l=new Worker(i.filename);l.onmessage=function(t){u.highlightedCode=t.data,i.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,s&&s.call(u.element),i.hooks.run("after-highlight",u),i.hooks.run("complete",u)},l.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=i.highlight(u.code,u.grammar,u.language),i.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,s&&s.call(e),i.hooks.run("after-highlight",u),i.hooks.run("complete",u)},highlight:function(t,e,s){var o=i.tokenize(t,e);return n.stringify(i.util.encode(o),s)},tokenize:function(t,e){var n=i.Token,s=[t],o=e.rest;if(o){for(var r in o)e[r]=o[r];delete e.rest}t:for(var r in e)if(e.hasOwnProperty(r)&&e[r]){var a=e[r];a="Array"===i.util.type(a)?a:[a];for(var h=0;h<a.length;++h){var u=a[h],l=u.inside,c=!!u.lookbehind,d=!!u.greedy,p=0,f=u.alias;if(d&&!u.pattern.global){var m=u.pattern.toString().match(/[imuy]*$/)[0];u.pattern=RegExp(u.pattern.source,m+"g")}u=u.pattern||u;for(var v=0,g=0;v<s.length;g+=(s[v].matchedStr||s[v]).length,++v){var y=s[v];if(s.length>t.length)break t;if(!(y instanceof n)){u.lastIndex=0;var w=u.exec(y),b=1;if(!w&&d&&v!=s.length-1){if(u.lastIndex=g,w=u.exec(t),!w)break;for(var A=w.index+(c?w[1].length:0),E=w.index+w[0].length,P=v,k=g,L=s.length;L>P&&E>k;++P)k+=(s[P].matchedStr||s[P]).length,A>=k&&(++v,g=k);if(s[v]instanceof n||s[P-1].greedy)continue;b=P-v,y=t.slice(g,k),w.index-=g}if(w){c&&(p=w[1].length);var A=w.index+p,w=w[0].slice(p),E=A+w.length,x=y.slice(0,A),N=y.slice(E),O=[v,b];x&&O.push(x);var D=new n(r,l?i.tokenize(w,l):w,f,w,d);O.push(D),N&&O.push(N),Array.prototype.splice.apply(s,O)}}}}}return s},hooks:{all:{},add:function(t,e){var n=i.hooks.all;n[t]=n[t]||[],n[t].push(e)},run:function(t,e){var n=i.hooks.all[t];if(n&&n.length)for(var s,o=0;s=n[o++];)s(e)}}},n=i.Token=function(t,e,i,n,s){this.type=t,this.content=e,this.alias=i,this.matchedStr=n||null,this.greedy=!!s};if(n.stringify=function(t,e,s){if("string"==typeof t)return t;if("Array"===i.util.type(t))return t.map(function(i){return n.stringify(i,e,t)}).join("");var o={type:t.type,content:n.stringify(t.content,e,s),tag:"span",classes:["token",t.type],attributes:{},language:e,parent:s};if("comment"==o.type&&(o.attributes.spellcheck="true"),t.alias){var r="Array"===i.util.type(t.alias)?t.alias:[t.alias];Array.prototype.push.apply(o.classes,r)}i.hooks.run("wrap",o);var a="";for(var h in o.attributes)a+=(a?" ":"")+h+'="'+(o.attributes[h]||"")+'"';return"<"+o.tag+' class="'+o.classes.join(" ")+'" '+a+">"+o.content+"</"+o.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(t){var e=JSON.parse(t.data),n=e.language,s=e.code,o=e.immediateClose;_self.postMessage(i.highlight(s,i.languages[n],n)),o&&_self.close()},!1),_self.Prism):_self.Prism;var s=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return s&&(i.filename=s.src,document.addEventListener&&!s.hasAttribute("data-manual")&&("loading"!==document.readyState?requestAnimationFrame(i.highlightAll,0):document.addEventListener("DOMContentLoaded",i.highlightAll))),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism),Prism.languages.markup={comment:/<!--[\w\W]*?-->/,prolog:/<\?[\w\W]+?\?>/,doctype:/<!DOCTYPE[\w\W]+?>/,cdata:/<!\[CDATA\[[\w\W]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=.$<]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\\1|\\?(?!\1)[\w\W])*\1|[^\s'">=]+))?)*\s*\/?>/i,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/i,inside:{punctuation:/[=>"']/}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},Prism.hooks.add("wrap",function(t){"entity"===t.type&&(t.attributes.title=t.content.replace(/&amp;/,"&"))}),Prism.languages.xml=Prism.languages.markup,Prism.languages.html=Prism.languages.markup,Prism.languages.mathml=Prism.languages.markup,Prism.languages.svg=Prism.languages.markup,Prism.languages.css={comment:/\/\*[\w\W]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^\{\}\s][^\{\};]*?(?=\s*\{)/,string:/("|')(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1/,property:/(\b|\B)[\w-]+(?=\s*:)/i,important:/\B!important\b/i,"function":/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},Prism.languages.css.atrule.inside.rest=Prism.util.clone(Prism.languages.css),Prism.languages.markup&&(Prism.languages.insertBefore("markup","tag",{style:{pattern:/(<style[\w\W]*?>)[\w\W]*?(?=<\/style>)/i,lookbehind:!0,inside:Prism.languages.css,alias:"language-css"}}),Prism.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|').*?\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:Prism.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:Prism.languages.css}},alias:"language-css"}},Prism.languages.markup.tag)),Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\w\W]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:{pattern:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,"boolean":/\b(true|false)\b/,"function":/[a-z0-9_]+(?=\()/i,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/},Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,"function":/[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*(?=\()/i}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}}),Prism.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\\\|\\?[^\\])*?`/,greedy:!0,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\w\W]*?>)[\w\W]*?(?=<\/script>)/i,lookbehind:!0,inside:Prism.languages.javascript,alias:"language-javascript"}}),Prism.languages.js=Prism.languages.javascript,!function(){function t(t,e){return Array.prototype.slice.call((e||document).querySelectorAll(t))}function e(t,e){return e=" "+e+" ",(" "+t.className+" ").replace(/[\n\t]/g," ").indexOf(e)>-1}function i(t,i,n){for(var o,r=i.replace(/\s+/g,"").split(","),a=+t.getAttribute("data-line-offset")||0,h=s()?parseInt:parseFloat,u=h(getComputedStyle(t).lineHeight),l=0;o=r[l++];){o=o.split("-");var c=+o[0],d=+o[1]||c,p=document.createElement("div");p.textContent=Array(d-c+2).join(" \n"),p.className=(n||"")+" line-highlight",e(t,"line-numbers")||(p.setAttribute("data-start",c),d>c&&p.setAttribute("data-end",d)),p.style.top=(c-a-1)*u+"px",e(t,"line-numbers")?t.appendChild(p):(t.querySelector("code")||t).appendChild(p)}}function n(){var e=location.hash.slice(1);t(".temporary.line-highlight").forEach(function(t){t.parentNode.removeChild(t)});var n=(e.match(/\.([\d,-]+)$/)||[,""])[1];if(n&&!document.getElementById(e)){var s=e.slice(0,e.lastIndexOf(".")),o=document.getElementById(s);o&&(o.hasAttribute("data-line")||o.setAttribute("data-line",""),i(o,n,"temporary "),document.querySelector(".temporary.line-highlight").scrollIntoView())}}if("undefined"!=typeof self&&self.Prism&&self.document&&document.querySelector){var s=function(){var t;return function(){if("undefined"==typeof t){var e=document.createElement("div");e.style.fontSize="13px",e.style.lineHeight="1.5",e.style.padding=0,e.style.border=0,e.innerHTML="&nbsp;<br />&nbsp;",document.body.appendChild(e),t=38===e.offsetHeight,document.body.removeChild(e)}return t}}(),o=0;Prism.hooks.add("complete",function(e){var s=e.element.parentNode,r=s&&s.getAttribute("data-line");s&&r&&/pre/i.test(s.nodeName)&&(clearTimeout(o),t(".line-highlight",s).forEach(function(t){t.parentNode.removeChild(t)}),i(s,r),o=setTimeout(n,1))}),window.addEventListener&&window.addEventListener("hashchange",n)}}(),!function(){"undefined"!=typeof self&&self.Prism&&self.document&&Prism.hooks.add("complete",function(t){if(t.code){var e=t.element.parentNode,i=/\s*\bline-numbers\b\s*/;if(e&&/pre/i.test(e.nodeName)&&(i.test(e.className)||i.test(t.element.className))&&!t.element.querySelector(".line-numbers-rows")){i.test(t.element.className)&&(t.element.className=t.element.className.replace(i,"")),i.test(e.className)||(e.className+=" line-numbers");var n,s=t.code.match(/\n(?!$)/g),o=s?s.length+1:1,r=new Array(o+1);r=r.join("<span></span>"),n=document.createElement("span"),n.className="line-numbers-rows",n.innerHTML=r,e.hasAttribute("data-start")&&(e.style.counterReset="linenumber "+(parseInt(e.getAttribute("data-start"),10)-1)),t.element.appendChild(n)}}})}(),!function(){function t(t){this.defaults=n({},t)}function e(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})}function i(t){for(var e=0,i=0;i<t.length;++i)t.charCodeAt(i)=="  ".charCodeAt(0)&&(e+=3);return t.length+e}if("undefined"!=typeof self&&self.Prism&&self.document){var n=Object.assign||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t};t.prototype={setDefaults:function(t){this.defaults=n(this.defaults,t)},normalize:function(t,i){i=n(this.defaults,i);for(var s in i){var o=e(s);"normalize"!==s&&"setDefaults"!==o&&i[s]&&this[o]&&(t=this[o].call(this,t,i[s]))}return t},leftTrim:function(t){return t.replace(/^\s+/,"")},rightTrim:function(t){return t.replace(/\s+$/,"")},tabsToSpaces:function(t,e){return e=0|e||4,t.replace(/\t/g,new Array(++e).join(" "))},spacesToTabs:function(t,e){return e=0|e||4,t.replace(new RegExp(" {"+e+"}","g")," ")},removeTrailing:function(t){return t.replace(/\s*?$/gm,"")},removeInitialLineFeed:function(t){return t.replace(/^(?:\r?\n|\r)/,"")},removeIndent:function(t){var e=t.match(/^[^\S\n\r]*(?=\S)/gm);return e&&e[0].length?(e.sort(function(t,e){return t.length-e.length}),e[0].length?t.replace(new RegExp("^"+e[0],"gm"),""):t):t},indent:function(t,e){return t.replace(/^[^\S\n\r]*(?=\S)/gm,new Array(++e).join(" ")+"$&")},breakLines:function(t,e){e=e===!0?80:0|e||80;for(var n=t.split("\n"),s=0;s<n.length;++s)if(!(i(n[s])<=e)){for(var o=n[s].split(/(\s+)/g),r=0,a=0;a<o.length;++a){var h=i(o[a]);r+=h,r>e&&(o[a]="\n"+o[a],r=h)}n[s]=o.join("")}return n.join("\n")}},Prism.plugins.NormalizeWhitespace=new t({"remove-trailing":!0,"remove-indent":!0,"left-trim":!0,"right-trim":!0}),Prism.hooks.add("before-highlight",function(t){var e=t.element.parentNode,i=/\bno-whitespace-normalization\b/;if(!(!t.code||!e||"pre"!==e.nodeName.toLowerCase()||t.settings&&t.settings["whitespace-normalization"]===!1||i.test(e.className)||i.test(t.element.className))){for(var n=e.childNodes,s="",o="",r=!1,a=Prism.plugins.NormalizeWhitespace,h=0;h<n.length;++h){var u=n[h];u==t.element?r=!0:"#text"===u.nodeName&&(r?o+=u.nodeValue:s+=u.nodeValue,e.removeChild(u),--h)}if(t.element.children.length&&Prism.plugins.KeepMarkup){var l=s+t.element.innerHTML+o;t.element.innerHTML=a.normalize(l,t.settings),t.code=t.element.textContent}else t.code=s+t.code+o,t.code=a.normalize(t.code,t.settings)}})}}();
function applyScale(){slideScale=slideWrap.offsetWidth>slideWrap.offsetHeight/slideRatio?slideWrap.offsetHeight/slideRatio/slideWidth:slideWrap.offsetWidth*slideRatio/slideHeight,slideScale=Math.max(Math.min(slideScale,slideScaleMax),slideScaleMin)+.001,slide.style.transform="scale("+slideScale+")"}function setScale(){applyScale(),clearTimeout(slideScaleTimeout),slideScaleTimeout=setTimeout(applyScale,332)}function onResize(t){setScale()}function toggleZoom(){isZoom=!isZoom,document.documentElement.classList.toggle("zoom"),setScale()}function loadSlide(t){slideRequest||(location.hash=t+1,slideIndicator.innerHTML=t+1,isDev&&(document.title=slides[t]+" // Start Making Games"),game&&"function"==typeof game.kill&&game.kill(),game=null,document.documentElement.classList.add("loading"),slideRequest=new XMLHttpRequest,slideRequest.open("GET","slides/"+slides[t]+"/index.html",!0),slideRequest.onload=function(){slideRequest.status>=200&&slideRequest.status<400&&(clearTimeout(slideTimeout),slideTimeout=setTimeout(function(){if(null!==lastSlide){var e=document.querySelector(".stylesheet-"+lastSlide);e&&e.parentNode.removeChild(e);var i=document.querySelector(".script-"+lastSlide);i&&i.parentNode.removeChild(i)}var s=document.createElement("link");s.rel="stylesheet",s.href="slides/"+slides[t]+"/index.css",s.classList.add("stylesheet-"+t),document.getElementsByTagName("head")[0].appendChild(s),slideContent.innerHTML=slideRequest.responseText;var h=document.createElement("script");h.setAttribute("src","slides/"+slides[t]+"/index.js"),h.classList.add("script-"+t),document.getElementsByTagName("head")[0].appendChild(h),setTimeout(function(){document.documentElement.classList.remove("loading")},32),slideRequest=null,Prism.highlightAll()},32))},slideRequest.send())}function prevSlide(){currentSlide>0&&!slideRequest&&(document.documentElement.classList.add("prev"),document.documentElement.classList.remove("next"),lastSlide=currentSlide,currentSlide--,loadSlide(currentSlide))}function nextSlide(){totalSlides-1>currentSlide&&!slideRequest&&(document.documentElement.classList.add("next"),document.documentElement.classList.remove("prev"),lastSlide=currentSlide,currentSlide++,loadSlide(currentSlide))}var slides=["intro-t-title-1","intro-t-jack-1","intro-t-quotes-1","intro-t-poll-1","intro-t-poll-2","build-c-html-1","build-c-css-pong-1","build-d-css-pong-1","build-c-css-paddles-1","build-d-css-paddles-1","build-c-css-score-1","build-d-css-score-1","build-c-css-net-ball-1","build-d-css-net-ball-1","build-c-js-structure-1","build-c-js-config-1","build-c-js-object-paddle-player-1","build-c-js-object-paddle-enemy-1","build-c-js-object-ball-1","build-c-js-object-score-1","build-c-js-render-1","build-d-js-render-1","build-c-js-move-ball-1","build-c-js-update-1","build-c-js-loop-1","build-c-js-init-1","build-d-js-loop-1","build-c-js-contain-ball-1","build-c-js-update-2","build-d-js-contain-ball-1","build-c-js-move-player-1","build-c-js-update-3","build-c-js-add-event-listeners-1","build-c-js-init-2","build-d-js-move-player-1","build-c-js-move-enemy-1","build-i-js-random-1","build-c-js-update-4","build-d-js-move-enemy-1","build-c-js-contain-paddles-1","build-c-js-update-5","build-d-js-contain-paddles-1","build-c-js-collision-aabb-1","build-i-js-aabb-separation-conditions-1","build-c-js-check-collisions-1","build-c-js-update-6","build-d-js-check-collisions-1","build-c-js-contain-ball-2","build-d-js-contain-ball-2","build-c-js-reset-ball-1","build-c-js-contain-ball-3","build-d-js-reset-ball-1","build-c-js-check-win-state-1","build-c-js-update-7","build-c-js-reset-game-1","build-d-js-check-win-state-1","juice-t-titles-1","juice-d-final-1"],game=null,slideWrap=document.querySelector(".slide-wrap"),slide=document.querySelector(".slide"),slideContent=document.querySelector(".slide-content"),slideBcr=slide.getBoundingClientRect(),slideWidth=slideBcr.width,slideHeight=slideBcr.height,slideRatio=slideHeight/slideWidth,slideScaleMin=0,slideScaleMax=1/0,slideScale,slideScaleTimeout;if(addEventListener("resize",onResize),setScale(),window.location.search.indexOf("dev")>-1){document.documentElement.classList.add("dev");var isDev=!0}if(window.location.search.indexOf("invert")>-1){document.documentElement.classList.add("invert");var isInverted=!0}var isZoom=!1;window.location.search.indexOf("zoom")>-1&&toggleZoom();var slideTimeout=null,currentSlide=location.hash?location.hash.slice(1)-1:0,lastSlide=null,totalSlides=slides.length,prevSlideButton=document.querySelector(".nav-prev"),nextSlideButton=document.querySelector(".nav-next"),slideIndicator=document.querySelector(".slide-indicator"),slideRequest;currentSlide>totalSlides&&(currentSlide=0),prevSlideButton.addEventListener("click",function(t){t.preventDefault(),prevSlide()}),nextSlideButton.addEventListener("click",function(t){t.preventDefault(),nextSlide()});var controlDownDownEvent=new Event("controlDownDown"),controlDownUpEvent=new Event("controlDownUp"),controlUpDownEvent=new Event("controlUpDown"),controlUpUpEvent=new Event("controlUpUp"),controlSpikeDownEvent=new Event("controlSpikeDown"),controlSpikeUpEvent=new Event("controlSpikeUp"),mouseLeftDownEvent=new Event("mouseLeftDown"),mouseLeftUpEvent=new Event("mouseLeftUp"),mouseRightDownEvent=new Event("mouseRightDown"),mouseRightUpEvent=new Event("mouseRightUp"),controlMuteDownEvent=new Event("controlMuteDown"),controlPauseDownEvent=new Event("controlPauseDown"),keyMap={up:["up","w"],right:["right","d"],down:["down","s"],left:["left","a"],spike:["space","1"],prev:["openbracket","l2"],next:["closebraket","l1"],mute:["m","r2"],pause:["p","r1"],refresh:["4"],zoom:["z","2"]},keys={up:0,right:0,down:0,left:0},dirs={up:document.querySelector(".dir-up"),right:document.querySelector(".dir-right"),down:document.querySelector(".dir-down"),left:document.querySelector(".dir-left")},pg=playground({mousemove:function(t){this.mouseIdle&&document.documentElement.classList.remove("mouse-idle"),this.mouseIdle=!1,this.mouseIdleTick=this.mouseIdleTickMax},mousedown:function(t){"left"==t.button&&window.dispatchEvent(mouseLeftDownEvent),"right"==t.button&&window.dispatchEvent(mouseRightDownEvent)},mouseup:function(t){"left"==t.button&&window.dispatchEvent(mouseLeftUpEvent),"right"==t.button&&window.dispatchEvent(mouseRightUpEvent)},keydown:function(t){keyMap.up.indexOf(t.key)>-1?(keys.up=1,dirs.up.classList.add("is-active"),window.dispatchEvent(controlUpDownEvent)):keyMap.right.indexOf(t.key)>-1?(keys.right=1,dirs.right.classList.add("is-active")):keyMap.down.indexOf(t.key)>-1?(keys.down=1,dirs.down.classList.add("is-active"),window.dispatchEvent(controlDownDownEvent)):keyMap.left.indexOf(t.key)>-1?(keys.left=1,dirs.left.classList.add("is-active")):keyMap.spike.indexOf(t.key)>-1?window.dispatchEvent(controlSpikeDownEvent):keyMap.prev.indexOf(t.key)>-1?prevSlide():keyMap.next.indexOf(t.key)>-1?nextSlide():keyMap.mute.indexOf(t.key)>-1?window.dispatchEvent(controlMuteDownEvent):keyMap.pause.indexOf(t.key)>-1?window.dispatchEvent(controlPauseDownEvent):keyMap.zoom.indexOf(t.key)>-1&&toggleZoom()},keyup:function(t){keyMap.up.indexOf(t.key)>-1?(keys.up=0,dirs.up.classList.remove("is-active"),window.dispatchEvent(controlUpUpEvent)):keyMap.right.indexOf(t.key)>-1?(keys.right=0,dirs.right.classList.remove("is-active")):keyMap.down.indexOf(t.key)>-1?(keys.down=0,dirs.down.classList.remove("is-active"),window.dispatchEvent(controlDownUpEvent)):keyMap.left.indexOf(t.key)>-1?(keys.left=0,dirs.left.classList.remove("is-active")):keyMap.spike.indexOf(t.key)>-1&&window.dispatchEvent(controlSpikeUpEvent)},gamepaddown:function(t){keyMap.up.indexOf(t.button)>-1?(keys.up=1,dirs.up.classList.add("is-active"),window.dispatchEvent(controlUpDownEvent)):keyMap.right.indexOf(t.button)>-1?(keys.right=1,dirs.right.classList.add("is-active")):keyMap.down.indexOf(t.button)>-1?(keys.down=1,dirs.down.classList.add("is-active"),window.dispatchEvent(controlDownDownEvent)):keyMap.left.indexOf(t.button)>-1?(keys.left=1,dirs.left.classList.add("is-active")):keyMap.spike.indexOf(t.button)>-1?window.dispatchEvent(controlSpikeDownEvent):keyMap.prev.indexOf(t.button)>-1?prevSlide():keyMap.next.indexOf(t.button)>-1?nextSlide():keyMap.mute.indexOf(t.button)>-1?window.dispatchEvent(controlMuteDownEvent):keyMap.pause.indexOf(t.button)>-1?window.dispatchEvent(controlPauseDownEvent):keyMap.refresh.indexOf(t.button)>-1?(this.refreshTick++,this.refreshTick>1&&location.reload(!0)):keyMap.zoom.indexOf(t.button)>-1&&toggleZoom()},gamepadup:function(t){keyMap.up.indexOf(t.button)>-1?(keys.up=0,dirs.up.classList.remove("is-active"),window.dispatchEvent(controlUpUpEvent)):keyMap.right.indexOf(t.button)>-1?(keys.right=0,dirs.right.classList.remove("is-active")):keyMap.down.indexOf(t.button)>-1?(keys.down=0,dirs.down.classList.remove("is-active"),window.dispatchEvent(controlDownUpEvent)):keyMap.left.indexOf(t.button)>-1?(keys.left=0,dirs.left.classList.remove("is-active")):keyMap.spike.indexOf(t.button)>-1&&window.dispatchEvent(controlSpikeUpEvent)},paths:{sounds:"snd/"},preferedAudioFormat:"mp3",create:function(){this.loadSounds(["paddle-1","wall-1","score-player-1","score-enemy-1","spike-1","spike-2","spike-3","slow-mo-1","hum-1","alarm-3","music-1"])},ready:function(){this.dt=.016,this.dtMs=16,this.dtNorm=1,this.time=0,this.timeMs=0,this.timeNorm=0,this.mouseIdle=!1,this.mouseIdleTickMax=180,this.mouseIdleTick=this.mouseIdleTickMax,this.refreshTick=0,this.humLoop=this.playSound("hum-1",!0),this.sound.setVolume(this.humLoop,0),this.sound.setPlaybackRate(this.humLoop,1),this.alarmLoop=this.playSound("alarm-3",!0),this.sound.setVolume(this.alarmLoop,0),this.sound.setPlaybackRate(this.alarmLoop,1),loadSlide(currentSlide)},step:function(t){this.manageTime(t),this.mouseIdle||(this.mouseIdleTick>0?this.mouseIdleTick--:(this.mouseIdle=!0,document.documentElement.classList.add("mouse-idle")))},startMusic:function(){this.song=this.music.play("music-1",!0),this.music.setVolume(this.song,.4)},stopMusic:function(){this.music.fadeOut(this.song),this.song=null},manageTime:function(t){this.dt=t,this.dtMs=1e3*this.dt,this.dtNorm=60*this.dt,this.time+=this.dt,this.timeMs+=this.dtMs,this.timeNorm+=this.dtNorm},getDt:function(){return"undefined"==typeof this.dtNorm?1:this.dtNorm},soundPlay:function(t){var e="undefined"==typeof t.name?null:t.name,i="undefined"==typeof t.volume?1:t.volume,s="undefined"==typeof t.rate?1:t.rate;if(e){var h=pg.playSound(e);pg.sound.setVolume(h,i),pg.sound.setPlaybackRate(h,s)}}}),G=function(t){this.config={paddle:{width:60,height:240,speed:16},ball:{width:60,height:60,speed:24,inc:1},score:{max:5}},this.raf=null,this.muted=!1,this.paused=!1,this.pausedTime=0,this.pausedStartTime=null,this.pausedEndTime=null,pg.startMusic(),this.stage=new this.Stage(this),this.paddlePlayer=new this.Paddle(this,!0),this.paddleEnemy=new this.Paddle(this,!1),this.paddleCollision=!1,this.ball=new this.Ball(this),this.scorePlayer=new this.Score(this,!0),this.scoreEnemy=new this.Score(this,!1),this.screenshake=new this.Screenshake(this),this.timescale=new this.Timescale(this),this.overlay=document.querySelector(".g-overlay"),this.edgeTop=document.querySelector(".g-edge-top"),this.edgeRight=document.querySelector(".g-edge-right"),this.edgeBot=document.querySelector(".g-edge-bot"),this.edgeLeft=document.querySelector(".g-edge-left"),this.particlesWhite=new this.Pool(this,this.ParticleWhite,30),this.particlesGreen=new this.Pool(this,this.ParticleGreen,30),this.particlesBlue=new this.Pool(this,this.ParticleBlue,30),this.pulsesWhite=new this.Pool(this,this.PulseWhite,30),this.pulsesGreen=new this.Pool(this,this.PulseGreen,30),this.pulsesBlue=new this.Pool(this,this.PulseBlue,30),this.init()};G.prototype.init=function(){this.addEventListeners(),this.loop()},G.prototype.reset=function(){this.scorePlayer.setValue(0),this.scoreEnemy.setValue(0),this.ball.speed=this.config.ball.speed,this.ball.reset()},G.prototype.checkWinState=function(){this.scorePlayer.value>=this.config.score.max?(console.log("You Won!"),this.reset()):this.scoreEnemy.value>=this.config.score.max&&(console.log("You Lost!"),this.reset())},G.prototype.step=function(){pg.music.setMaster(this.timescale.current),this.stage.step(),this.paused||(this.paddlePlayer.step(),this.paddleEnemy.step(),this.ball.step(),this.screenshake.step(),this.timescale.step(),this.particlesWhite.each("step"),this.particlesGreen.each("step"),this.particlesBlue.each("step"),this.pulsesWhite.each("step"),this.pulsesGreen.each("step"),this.pulsesBlue.each("step"),this.checkWinState(),this.paddleCollision=!1)},G.prototype.draw=function(){this.stage.draw(),this.paddlePlayer.draw(),this.paddleEnemy.draw(),this.ball.draw(),this.scorePlayer.draw(),this.scoreEnemy.draw(),this.particlesWhite.each("draw"),this.particlesGreen.each("draw"),this.particlesBlue.each("draw"),this.pulsesWhite.each("draw"),this.pulsesGreen.each("draw"),this.pulsesBlue.each("draw")},G.prototype.loop=function(){this.raf=requestAnimationFrame(this.loop.bind(this)),this.step(),this.draw()},G.prototype.kill=function(){cancelAnimationFrame(this.raf),pg.stopMusic(),this.config=null,this.stage=null,this.ball=null,this.paddlePlayer=null,this.paddleEnemy=null,this.scorePlayer=null,this.scoreEnemy=null,this.screenshake=null,this.timescale=null,this.unpause(),this.removeEventListeners()},G.prototype.Stage=function(t){this.g=t,this.elem=document.querySelector(".g-pong"),this.xDeg=0,this.xDegTarget=0,this.yDeg=0,this.yDegTarget=0,this.rangeDeg=10,this.xTrans=0,this.xTransTarget=0,this.yTrans=0,this.yTransTarget=0,this.smoothingDeg=.05,this.rotation=0,this.scaleBase=.85,this.scale=this.scaleBase,this.width=1920,this.height=1080},G.prototype.Stage.prototype.step=function(){this.xDegTarget=2*(this.g.ball.y/(this.height-this.g.ball.height)-.5)*this.rangeDeg,this.xDeg+=(this.xDegTarget-this.xDeg)*this.smoothingDeg,this.yDegTarget=2*(this.g.ball.x/(this.width-this.g.ball.width)-.5)*this.rangeDeg,this.yDeg+=(this.yDegTarget-this.yDeg)*this.smoothingDeg,this.xTransTarget=.1*(-this.g.ball.x+this.width/2)*(10*(1-this.g.timescale.current)),this.xTrans+=(this.xTransTarget-this.xTrans)*this.smoothingDeg,this.yTransTarget=.1*(-this.g.ball.y+this.height/2)*(10*(1-this.g.timescale.current)),this.yTrans+=(this.yTransTarget-this.yTrans)*this.smoothingDeg,this.rotation=this.g.screenshake.angle,this.scale=this.scaleBase+.3*(1-this.g.timescale.current)},G.prototype.Stage.prototype.draw=function(){this.g.css(this.elem,"transform","scale( "+this.scale+" ) translateX("+(this.xTrans+this.g.screenshake.x)+"px) translateY("+(this.yTrans+this.g.screenshake.y)+"px) rotateX("+-this.xDeg+"deg) rotateY("+this.yDeg+"deg) rotateZ("+this.rotation+"rad)")},G.prototype.Ball=function(t){this.g=t,this.elem=document.querySelector(".g-ball-normal"),this.serving=!0,this.servingTimer=0,this.servingTimerMax=60,this.x=this.g.stage.width/2-this.g.config.ball.width/2,this.y=this.g.stage.height/2-this.g.config.ball.height/2,this.z=60,this.speed=this.g.config.ball.speed,this.vx=0,this.vy=0,this.friction=.9,this.width=this.g.config.ball.width,this.height=this.g.config.ball.height,this.rotation=Math.PI/4,this.opacity=1,this.wasSpiked=!1,this.ghost={elem:document.querySelector(".g-ball-ghost"),x:this.x,y:this.y,z:60,vx:0,vy:0,rotation:Math.PI/4,active:!1},this.reset()},G.prototype.Ball.prototype.reset=function(){this.serving=!0,this.x=this.g.stage.width/2-this.width/2,this.y=this.g.stage.height/2-this.height/2+this.g.stage.height/3,this.opacity=0,this.ghost.active=!1;pg.tween(this).to({y:this.g.stage.height/2-this.height/2,opacity:1},.65,"inOutExpo");this.vx=0,this.vy=0,this.g.paddlePlayer.hasHit=!1,this.g.paddleEnemy.hasHit=!1},G.prototype.Ball.prototype.contain=function(){if(this.y<=0||this.y+this.height>=this.g.stage.height){this.y<=0?(this.y=0,this.g.triggerClass(this.g.edgeTop,"hit")):(this.y=this.g.stage.height-this.height,this.g.triggerClass(this.g.edgeBot,"hit")),this.vy=-this.vy,pg.soundPlay({name:"wall-1",volume:.5,rate:this.g.rand(2,3)*(1-.4*(1-this.g.timescale.current))});var t=Math.atan2(this.vy,this.vx);this.g.screenshake.apply({translate:10,rotate:.15,xBias:0*Math.cos(t),yBias:-75*Math.sin(t)});for(var e=0;15>e;e++){var i=this.g.rand(10,20);this.g.particlesWhite.create({width:i,height:i,x:this.x+this.g.rand(0,this.width)-i/2,y:this.y+this.g.rand(0,this.height)-i/2,z:this.g.rand(0,60),vx:this.g.rand(-3,3),vy:this.g.rand(-3,3),vz:this.g.rand(-2,2),rx:this.g.rand(0,2*Math.PI),ry:this.g.rand(0,2*Math.PI),rz:this.g.rand(0,2*Math.PI),decay:this.g.rand(.01,.05),friction:.99,shrink:!0,opacity:1})}i=60,this.g.pulsesWhite.create({width:i,height:i,x:this.x+this.width/2-i/2,y:this.y+this.height/2-i/2,z:1,r:Math.PI/4,shrink:!1,decay:.05,opacity:1})}(this.ghost.y<=0||this.ghost.y+this.height>=this.g.stage.height)&&(this.ghost.y<=0?this.ghost.y=0:this.ghost.y=this.g.stage.height-this.height,this.ghost.vy=-this.ghost.vy);var s=!1;if(!this.g.paddleCollision&&this.x+this.width>this.g.stage.width&&(s=!0,this.g.scorePlayer.setValue(this.g.scorePlayer.value+1),this.g.triggerClass(this.g.edgeRight,"hit"),this.g.triggerClass(this.g.scorePlayer.elem,"scored"),pg.soundPlay({name:"score-player-1",volume:.3,rate:2*(1-.4*(1-this.g.timescale.current))})),this.ghost.active&&this.ghost.x+this.width>this.g.stage.width&&(this.ghost.vx=0,this.ghost.vy=0),!this.g.paddleCollision&&this.x<0&&(s=!0,this.g.scoreEnemy.setValue(this.g.scoreEnemy.value+1),this.g.triggerClass(this.g.edgeLeft,"hit"),this.g.triggerClass(this.g.scoreEnemy.elem,"scored"),pg.soundPlay({name:"score-enemy-1",volume:.7,rate:1*(1-.4*(1-this.g.timescale.current))})),s){this.speed+=this.g.config.ball.inc,this.g.triggerClass(this.g.overlay,"flash"),this.wasSpiked=!1;for(var e=0;15>e;e++){var i=this.g.rand(10,20);this.g.particlesWhite.create({width:i,height:i,x:this.x+this.g.rand(0,this.width)-i/2,y:this.y+this.g.rand(0,this.height)-i/2,z:this.g.rand(0,60),vx:this.g.rand(-3,3),vy:this.g.rand(-3,3),vz:this.g.rand(-2,2),rx:this.g.rand(0,2*Math.PI),ry:this.g.rand(0,2*Math.PI),rz:this.g.rand(0,2*Math.PI),decay:this.g.rand(.01,.05),friction:.99,shrink:!0,opacity:1})}i=60,this.g.pulsesWhite.create({width:i,height:i,x:this.x+this.width/2-i/2,y:this.y+this.height/2-i/2,z:1,r:Math.PI/4,shrink:!1,decay:.05,opacity:1}),this.reset()}},G.prototype.Ball.prototype.step=function(){if(this.contain(),this.serving)this.servingTimer<this.servingTimerMax?this.servingTimer++:(this.serving=!1,this.servingTimer=0,this.vx=this.speed,this.vy=this.speed),this.rotation=Math.PI/4;else{if(this.vx>0?(this.rotation+=.005*Math.abs(this.vx)*this.g.timescale.getDt(),this.ghost.rotation+=.005*Math.abs(this.ghost.vx)*this.g.timescale.getDt()):(this.rotation-=.005*Math.abs(this.vx)*this.g.timescale.getDt(),this.ghost.rotation-=.005*Math.abs(this.ghost.vx)*this.g.timescale.getDt()),this.x+=this.vx*this.g.timescale.getDt(),this.y+=this.vy*this.g.timescale.getDt(),this.ghost.x+=this.ghost.vx*this.g.timescale.getDt(),this.ghost.y+=this.ghost.vy*this.g.timescale.getDt(),Math.sqrt(this.vx*this.vx+this.vy*this.vy)>this.speed&&(this.vx*=Math.pow(this.friction,this.g.timescale.getDt()),this.vy*=Math.pow(this.friction,this.g.timescale.getDt()),this.ghost.vx*=Math.pow(this.friction,this.g.timescale.getDt()),this.ghost.vy*=Math.pow(this.friction,this.g.timescale.getDt())),Math.random()<.5*this.g.timescale.getDt()){var t=60;this.wasSpiked?this.g.pulsesGreen.create({width:t,height:t,x:this.x+this.width/2-t/2,y:this.y+this.height/2-t/2,z:1+this.g.rand(0,60),r:this.rotation,shrink:!0,decay:.06,opacity:.25}):this.g.pulsesWhite.create({width:t,height:t,x:this.x+this.width/2-t/2,y:this.y+this.height/2-t/2,z:1+this.g.rand(0,60),r:this.rotation,shrink:!0,decay:.06,opacity:.25})}if(Math.random()<.5*this.g.timescale.getDt()){var t=this.g.rand(10,20);this.wasSpiked?this.g.particlesGreen.create({width:t,height:t,x:this.x+this.g.rand(0,this.width)-t/2,y:this.y+this.g.rand(0,this.height)-t/2,z:this.g.rand(0,60),vx:-this.vx/3,vy:-this.vy/3,vz:this.g.rand(-2,2),rx:this.g.rand(0,2*Math.PI),ry:this.g.rand(0,2*Math.PI),rz:this.g.rand(0,2*Math.PI),decay:this.g.rand(.01,.1),friction:.95,shrink:!0,opacity:1}):this.g.particlesWhite.create({width:t,height:t,x:this.x+this.g.rand(0,this.width)-t/2,y:this.y+this.g.rand(0,this.height)-t/2,z:this.g.rand(0,60),vx:-this.vx/3,vy:-this.vy/3,vz:this.g.rand(-2,2),rx:this.g.rand(0,2*Math.PI),ry:this.g.rand(0,2*Math.PI),rz:this.g.rand(0,2*Math.PI),decay:this.g.rand(.01,.1),friction:.95,shrink:!0,opacity:1})}}},G.prototype.Ball.prototype.draw=function(){this.g.css(this.elem,{opacity:this.opacity,transform:"translate3d("+this.x+"px, "+this.y+"px, "+this.z+"px) rotateZ("+this.rotation+"rad)"})},G.prototype.Paddle=function(t,e){this.g=t,this.isPlayer=e,this.isEnemy=!e,this.y=this.g.stage.height/2-this.g.config.paddle.height/2,this.z=60,this.vx=0,this.vy=0,this.vxMax=100,this.vyMax=25,this.ax=20,this.ay=2,this.friction=.85,this.width=this.g.config.paddle.width,this.height=this.g.config.paddle.height,this.speed=this.g.config.paddle.speed,this.angle=0,this.moveUp=!1,this.moveDown=!1,this.hasHit=!1,this.isSpiking=!1,this.canSpike=!0,this.isCharging=!1,this.currentCharge=0,this.spikeRange=200,this.spikeTarget=0,this.chargeRate=.0075,this.chargeDecay=.075,this.lastCharge=0,this.isPlayer?(this.elem=document.querySelector(".g-paddle-player"),this.x=0):(this.elem=document.querySelector(".g-paddle-enemy"),this.x=this.g.stage.width-this.g.config.paddle.width),this.chargeElem=document.querySelector(".g-charge"),this.xOrigin=this.x},G.prototype.Paddle.prototype.contain=function(){this.y<0&&(this.y=0,this.vy=0,this.moveUp=!1),this.y>this.g.stage.height-this.height&&(this.y=this.g.stage.height-this.height,this.vy=0,this.moveDown=!1)},G.prototype.Paddle.prototype.spike=function(){this.canSpike&&(this.isSpiking=!0,this.spikeTarget=this.spikeRange*this.currentCharge,this.lastCharge=this.currentCharge,this.g.removeClass(this.elem,"hit"))},G.prototype.Paddle.prototype.checkCollisions=function(){var t;if(t=this.isPlayer?{x:this.x-1e3,y:this.y,width:this.width+1e3,height:this.height}:{x:this.x,y:this.y,width:this.width+1e3,height:this.height},this.g.collisionAABB(this.g.ball,t)){if(this.isPlayer&&this.g.ball.vx>0)return;if(this.isEnemy&&this.g.ball.vx<0)return;this.g.paddleCollision=!0;var e,i,s,h;if(this.isPlayer){e=-Math.PI/4,i=Math.sqrt(this.g.ball.vx*this.g.ball.vx+this.g.ball.vy*this.g.ball.vy),this.isSpiking?(pg.soundPlay({name:"spike-1",volume:.8*this.lastCharge,rate:this.g.rand(1,1.6)*(1-.4*(1-this.g.timescale.current))}),pg.soundPlay({name:"spike-2",volume:.8*this.lastCharge,rate:this.g.rand(1,1.6)*(1-.4*(1-this.g.timescale.current))}),pg.soundPlay({name:"spike-3",volume:.8*this.lastCharge,rate:this.g.rand(1,1.6)*(1-.4*(1-this.g.timescale.current))}),s=this.lastCharge>=1?200*this.lastCharge:150*this.lastCharge):s=0,h=i+s,this.isSpiking&&this.lastCharge>=1?(this.g.ball.wasSpiked=!0,this.g.timescale.triggerSlowMo(),this.g.triggerClass(this.g.overlay,"flash")):this.g.ball.wasSpiked=!1,e=.35*-Math.PI+(this.g.ball.y+this.g.ball.height-this.y)/(this.height+this.g.ball.height)*Math.PI*.7,this.g.ball.x=this.x+this.width,this.g.ball.vx=Math.cos(e)*h,this.g.ball.vy=Math.sin(e)*h,this.angle=e/2;for(var o=0;15>o;o++){var n=this.g.rand(10,20);this.g.particlesGreen.create({width:n,height:n,x:this.x+this.g.rand(0,this.width)-n/2,y:this.y+this.g.rand(0,this.height)-n/2,z:this.g.rand(60,120),vx:this.g.rand(-8,-4),vy:this.g.rand(-1,1),vz:this.g.rand(-4,4),rx:this.g.rand(0,2*Math.PI),ry:this.g.rand(0,2*Math.PI),rz:this.g.rand(0,2*Math.PI),decay:this.g.rand(.01,.05),friction:.95,shrink:!0,opacity:1})}n=60,this.g.pulsesGreen.create({width:n,height:n,x:this.g.ball.x+this.g.ball.width/2-n/2,y:this.g.ball.y+this.g.ball.height/2-n/2,z:1,r:Math.PI/4,shrink:!1,decay:.05,opacity:1})}else{this.g.ball.x=this.x-this.g.ball.width,e=-Math.PI/4,i=Math.sqrt(this.g.ball.vx*this.g.ball.vx+this.g.ball.vy*this.g.ball.vy),h=i,this.g.ball.wasSpiked=!1,e=.35*-Math.PI+(this.g.ball.y+this.g.ball.height-this.y)/(this.height+this.g.ball.height)*Math.PI*.7,this.g.ball.x=this.x-this.g.ball.width,this.g.ball.vx=Math.cos(e)*-h,this.g.ball.vy=Math.sin(e)*h,this.angle=-e/2;for(var o=0;15>o;o++){var n=this.g.rand(10,20);this.g.particlesBlue.create({width:n,height:n,x:this.x+this.g.rand(0,this.width)-n/2,y:this.y+this.g.rand(0,this.height)-n/2,z:this.g.rand(60,120),vx:this.g.rand(4,8),vy:this.g.rand(-1,1),vz:this.g.rand(-4,4),rx:this.g.rand(0,2*Math.PI),ry:this.g.rand(0,2*Math.PI),rz:this.g.rand(0,2*Math.PI),decay:this.g.rand(.01,.05),friction:.95,shrink:!0,opacity:1})}n=60,this.g.pulsesBlue.create({width:n,height:n,x:this.g.ball.x+this.g.ball.width/2-n/2,y:this.g.ball.y+this.g.ball.height/2-n/2,z:1,r:Math.PI/4,shrink:!1,decay:.05,opacity:1})}for(var o=0;15>o;o++){var n=this.g.rand(10,20);this.g.particlesWhite.create({width:n,height:n,x:this.g.ball.x+this.g.rand(0,this.g.ball.width)-n/2,y:this.g.ball.y+this.g.rand(0,this.g.ball.height)-n/2,z:this.g.rand(0,60),vx:this.g.rand(-3,3),vy:this.g.rand(-3,3),vz:this.g.rand(-2,2),rx:this.g.rand(0,2*Math.PI),ry:this.g.rand(0,2*Math.PI),rz:this.g.rand(0,2*Math.PI),decay:this.g.rand(.01,.05),friction:.99,shrink:!0,opacity:1})}this.g.triggerClass(this.elem,"hit"),this.hasHit=!0;var a=Math.atan2(this.g.ball.vy,this.g.ball.vx);this.isSpiking?this.g.screenshake.apply({translate:10+100*this.lastCharge,rotate:.3,xBias:Math.cos(a)*(400+400*this.lastCharge),yBias:0*Math.sin(a)}):this.g.screenshake.apply({translate:10,rotate:.3,xBias:400*Math.cos(a),yBias:0*Math.sin(a)}),pg.soundPlay({name:"paddle-1",volume:.7,rate:this.g.rand(1,1.6)*(1-.4*(1-this.g.timescale.current))}),this.isPlayer?(this.g.ball.ghost.active=!0,this.g.ball.ghost.x=this.g.ball.x,this.g.ball.ghost.y=this.g.ball.y,this.g.ball.ghost.vx=Math.cos(e)*(2*h),this.g.ball.ghost.vy=Math.sin(e)*(2*h)):this.g.ball.ghost.active=!1}},G.prototype.Paddle.prototype.step=function(){if(this.isEnemy&&(!this.hasHit||Math.random()<.4)&&(this.moveUp=!1,this.moveDown=!1,this.g.ball.ghost.active?this.g.ball.ghost.y+this.g.ball.height<this.y+this.height/2?this.moveUp=!0:this.g.ball.ghost.y>this.y+this.height/2&&(this.moveDown=!0):this.g.ball.y+this.g.ball.height<this.y+this.height/2?this.moveUp=!0:this.g.ball.y>this.y+this.height/2&&(this.moveDown=!0)),this.moveUp?this.vy-=this.ay*this.g.timescale.getDt():this.moveDown?this.vy+=this.ay*this.g.timescale.getDt():this.vy*=this.friction,this.angle+=.1*(0-this.angle),this.isSpiking?(this.canSpike=!1,this.vx+=this.ax):this.vx-=this.ax/20,this.vx<-this.vxMax&&(this.vx=-this.vxMax),this.vx>this.vxMax&&(this.vx=this.vxMax),this.vy<-this.vyMax&&(this.vy=-this.vyMax),this.vy>this.vyMax&&(this.vy=this.vyMax),this.x+=this.vx*this.g.timescale.getDt(),this.isCharging&&this.currentCharge>0&&this.currentCharge<=1?this.y+=this.vy/(1+7*this.currentCharge)*this.g.timescale.getDt():this.y+=this.vy*this.g.timescale.getDt(),this.isCharging&&this.currentCharge<1&&this.canSpike&&(this.currentCharge+=this.chargeRate*this.g.timescale.getDt()),(!this.isCharging&&this.currentCharge>0||!this.canSpike)&&(this.currentCharge-=this.chargeDecay*this.g.timescale.getDt()),this.currentCharge=Math.max(0,this.currentCharge),this.currentCharge=Math.min(1,this.currentCharge),this.currentCharge>0&&Math.random()<this.currentCharge/3){var t=this.g.rand(10,20);this.g.particlesGreen.create({width:t,height:t,x:this.x,y:this.y+this.g.rand(0,this.height)-t/2,z:this.g.rand(0,60),vx:this.g.rand(-20,-10),vy:this.g.rand(-2,2),vz:this.g.rand(-2,2),rx:this.g.rand(0,2*Math.PI),ry:this.g.rand(0,2*Math.PI),rz:this.g.rand(0,2*Math.PI),decay:this.g.rand(.01,.05),friction:.9,shrink:!0,opacity:1})}this.x>this.spikeTarget&&(this.x=this.spikeTarget,this.vx=0,this.isSpiking=!1),this.x<this.xOrigin&&(this.x=this.xOrigin,this.vx=0,this.canSpike||(this.canSpike=!0)),this.isPlayer&&(pg.sound.setVolume(pg.humLoop,.6*this.currentCharge),pg.sound.setPlaybackRate(pg.humLoop,5*this.currentCharge),pg.sound.setVolume(pg.alarmLoop,.5*this.currentCharge),pg.sound.setPlaybackRate(pg.alarmLoop,3*this.currentCharge)),this.isPlayer&&this.currentCharge>=1&&this.g.addClass(this.elem,"hit"),this.contain(),this.checkCollisions()},G.prototype.Paddle.prototype.draw=function(){this.isCharging?this.g.css(this.elem,{opacity:this.currentCharge<1?1:.75+.25*Math.cos(Date.now()/30),transform:"translate3d("+(this.x+this.g.rand(5*-this.currentCharge,5*this.currentCharge))+"px, "+(this.y+this.g.rand(5*-this.currentCharge,5*this.currentCharge))+"px, "+this.z+"px) rotateZ("+(this.angle+this.g.rand(.05*-this.currentCharge,.05*this.currentCharge))+"rad)"}):this.g.css(this.elem,{opacity:1,transform:"translate3d("+this.x+"px, "+this.y+"px, "+this.z+"px) rotateZ("+this.angle+"rad)"}),this.isPlayer&&this.g.css(this.chargeElem,{opacity:this.currentCharge<1?this.currentCharge:.75+.25*Math.sin(Date.now()/30),transform:"scaleX("+(.23+.77*this.currentCharge)+") translateZ( 1px )"})},G.prototype.Score=function(t,e){this.g=t,this.isPlayer=e,this.isEnemy=!e,this.value=0,this.flag=!0,this.isPlayer?this.elem=document.querySelector(".g-score-player"):this.elem=document.querySelector(".g-score-enemy")},G.prototype.Score.prototype.setValue=function(t){this.value=t,this.flag=!0},G.prototype.Score.prototype.draw=function(){this.flag&&(this.g.text(this.elem,this.value),this.g.attr(this.elem,"data-score",this.value.toString()),this.flag=!1)},G.prototype.Screenshake=function(t){this.g=t,this.translate=0,this.rotate=0,this.x=0,this.y=0,this.xTarget=0,this.yTarget=0,this.xBias=0,this.yBias=0,this.angle=0,this.angleTarget=0},G.prototype.Screenshake.prototype.apply=function(t){this.translate=t.translate,this.rotate=t.rotate,this.xBias=t.xBias,this.yBias=t.yBias},G.prototype.Screenshake.prototype.step=function(){this.xBias*=.9,this.yBias*=.9,this.translate>0?(this.translate*=.9,this.xTarget=this.g.rand(-this.translate,this.translate)+this.xBias,this.yTarget=this.g.rand(-this.translate,this.translate)+this.yBias):(this.xTarget=0,this.yTarget=0),this.rotate>0?(this.rotate*=.9,this.angleTarget=this.g.rand(-this.rotate,this.rotate)):this.angleTarget=0,this.x+=.1*(this.xTarget-this.x),this.y+=.1*(this.yTarget-this.y),this.angle+=.1*(this.angleTarget-this.angle)},G.prototype.Timescale=function(t){this.g=t,this.current=1,this.target=.15,this.timer=0,this.timerMax=40,this.inDuration=.2,this.outDuration=.6,this.isSlow=!1},G.prototype.Timescale.prototype.step=function(){this.isSlow&&(this.timer<this.timerMax?this.timer+=this.getCoreDt():(this.timer=0,this.isSlow=!1,pg.tween(this).to({current:1},this.outDuration,"inQuad")))},G.prototype.Timescale.prototype.triggerSlowMo=function(){if(!this.isSlow){var t=pg.playSound("slow-mo-1");pg.sound.setVolume(t,1),this.isSlow=!0,pg.tween(this).to({current:this.target},this.inDuration,"outQuad")}},G.prototype.Timescale.prototype.getDt=function(){return pg.getDt()*this.current},G.prototype.Timescale.prototype.getInverseDt=function(){return 1-pg.getDt()*this.current},G.prototype.Timescale.prototype.getCoreDt=function(){return pg.getDt()},G.prototype.Timescale.prototype.getCoreInverseDt=function(){return 1-pg.getDt()},G.prototype.addEventListeners=function(){this.controlUpDownBound=this.onControlUpDown.bind(this),this.controlDownDownBound=this.onControlDownDown.bind(this),this.controlSpikeDownBound=this.onControlSpikeDown.bind(this),this.controlUpUpBound=this.onControlUpUp.bind(this),this.controlDownUpBound=this.onControlDownUp.bind(this),this.controlSpikeUpBound=this.onControlSpikeUp.bind(this),this.mouseLeftDownBound=this.onMouseLeftDown.bind(this),this.controlMuteDownBound=this.onControlMuteDown.bind(this),this.controlPauseDownBound=this.onControlPauseDown.bind(this),window.addEventListener("controlUpDown",this.controlUpDownBound),window.addEventListener("controlDownDown",this.controlDownDownBound),window.addEventListener("controlSpikeDown",this.controlSpikeDownBound),window.addEventListener("controlUpUp",this.controlUpUpBound),window.addEventListener("controlDownUp",this.controlDownUpBound),window.addEventListener("controlSpikeUp",this.controlSpikeUpBound),window.addEventListener("mouseLeftDown",this.mouseLeftDownBound),
window.addEventListener("controlMuteDown",this.controlMuteDownBound),window.addEventListener("controlPauseDown",this.controlPauseDownBound)},G.prototype.removeEventListeners=function(){window.removeEventListener("controlUpDown",this.controlUpDownBound),window.removeEventListener("controlDownDown",this.controlDownDownBound),window.removeEventListener("controlSpikeDown",this.controlSpikeDownBound),window.removeEventListener("controlUpUp",this.controlUpUpBound),window.removeEventListener("controlDownUp",this.controlDownUpBound),window.removeEventListener("controlSpikeUp",this.controlSpikeUpBound),window.removeEventListener("mouseLeftDown",this.mouseLeftDownBound),window.removeEventListener("controlMuteDown",this.controlMuteDownBound),window.removeEventListener("controlPauseDown",this.controlPauseDownBound)},G.prototype.onControlUpDown=function(){this.paddlePlayer.moveUp=!0},G.prototype.onControlDownDown=function(){this.paddlePlayer.moveDown=!0},G.prototype.onControlSpikeDown=function(){this.paddlePlayer.isCharging=!0},G.prototype.onControlUpUp=function(){this.paddlePlayer.moveUp=!1},G.prototype.onControlDownUp=function(){this.paddlePlayer.moveDown=!1},G.prototype.onControlSpikeUp=function(){this.paused||(this.paddlePlayer.isCharging=!1,this.paddlePlayer.spike())},G.prototype.onMouseLeftDown=function(){},G.prototype.onControlMuteDown=function(){this.muteToggle()},G.prototype.onControlPauseDown=function(){this.pauseToggle()},G.prototype.muteToggle=function(){this.muted?this.unmute():this.mute()},G.prototype.mute=function(){this.muted=!0,pg.sound.setMaster(0),pg.music.setMaster(0)},G.prototype.unmute=function(){this.muted=!1,pg.sound.setMaster(1),pg.music.setMaster(1)},G.prototype.pauseToggle=function(){this.paused?this.unpause():this.pause()},G.prototype.pause=function(){this.paused=!0,document.documentElement.classList.add("paused"),pg.sound.setVolume(pg.humLoop,0)},G.prototype.unpause=function(){this.paused=!1,document.documentElement.classList.remove("paused")},G.prototype.rand=function(t,e){return Math.random()*(e-t)+t},G.prototype.randInt=function(t,e){return Math.floor(t+Math.random()*(e-t+1))},G.prototype.collisionAABB=function(t,e){return t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y?void 0:!0},G.prototype.isString=function(t){return"string"==typeof t},G.prototype.isObject=function(t){return"object"==typeof t},G.prototype.isSet=function(t){return"undefined"!=typeof t},G.prototype.isObjEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},G.prototype.merge=function(t,e){for(var i in e)t[i]=e[i]},G.prototype.Pool=function(t,e,i){this.g=t,this.base=e,this.preallocateAmount=i||0,this.alive=[],this.dead=[],this.length=0,this.deadLength=0,this.preallocateAmount&&this.preallocate()},G.prototype.Pool.prototype.preallocate=function(){for(var t=0;t<this.preallocateAmount;t++)this.dead.push(new this.base(this.g,this)),this.deadLength++},G.prototype.Pool.prototype.create=function(t){if(this.deadLength){var e=this.dead.pop();return e.init(t),this.alive.push(e),this.deadLength--,this.length++,e}var i=new this.base(this.g,this);return i.init(t),this.alive.push(i),this.length++,i},G.prototype.Pool.prototype.release=function(t){var e=this.alive.indexOf(t);e>-1&&(this.dead.push(this.alive.splice(e,1)[0]),this.length--,this.deadLength++)},G.prototype.Pool.prototype.empty=function(){this.alive.length=0,this.dead.length=0,this.length=0,this.deadLength=0},G.prototype.Pool.prototype.each=function(t,e){for(var i=this.length;i--;)this.alive[i][t](i)},G.prototype.qS=function(t){var e=document.querySelectorAll(t);return e.length>1?e:e[0]},G.prototype.cE=function(t,e){var i=document.createElement("div");return t&&t.appendChild(i),e&&this.addClass(i,e),i},G.prototype.text=function(t,e){t.firstChild.nodeValue=e},G.prototype.triggerClass=function(t,e){this.addClass(t,e),t.offsetWidth=t.offsetWidth,this.removeClass(t,e)},G.prototype.prefixMatches={},G.prototype.prefixCheck=function(t){if(this.prefixElement||(this.prefixElement=this.cE()),this.prefixMatches[t])return[this.prefixMatches[t],!0];for(var e=["","Webkit","Moz","ms","O"],i=function(t){return t.toUpperCase()},s=0,h=e.length;h>s;s++){var o;if(o=0===s?t:e[s]+t.replace(/^\w/,i),this.isString(this.prefixElement.style[o]))return this.prefixMatches[t]=o,[o,!0]}return[t,!1]},G.prototype.css=function(t,e,i){if(this.isObject(e)){var s=e;for(e in s)s.hasOwnProperty(e)&&this.css(t,e,s[e])}else e=this.prefixCheck(e),e[1]&&(t.style[e[0]]=i)},G.prototype.hasClass=function(t,e){return e?t.classList.contains(e):void 0},G.prototype.addClass=function(t,e){e.length&&(-1!=e.indexOf(" ")?(classes=e.split(" "),classes.forEach(function(e){G.hasClass(t,e)||G.addClass(t,e)})):t.classList.add(e))},G.prototype.removeClass=function(t,e){-1!=e.indexOf(" ")?(classes=e.split(" "),classes.forEach(function(e){this.hasClass(t,e)&&this.removeClass(t,e)})):t.classList.remove(e)},G.prototype.attr=function(t,e,i){return i?(t.setAttribute(e,i),i):t.getAttribute(e)},G.prototype.Particle=function(t,e){this.g=t,this.parent=e,this.elem=this.g.cE(this.g.stage.elem,"g-particle"),this.g.css(this.elem,{opacity:0,transform:"translate3d(-999px , -999px, 0)"})},G.prototype.Particle.prototype.init=function(t){this.width=t.width,this.height=t.height,this.x=t.x,this.y=t.y,this.z=t.z,this.vx=t.vx,this.vy=t.vy,this.vz=t.vz,this.rx=t.rx,this.ry=t.ry,this.rz=t.rz,this.decay=t.decay,this.friction=t.friction,this.shrink=t.shrink,this.opacityBase=t.opacity,this.life=1,this.scale=1,this.opacity=this.opacityBase},G.prototype.Particle.prototype.step=function(){this.vx*=this.friction,this.vy*=this.friction,this.vz*=this.friction,this.x+=this.vx*this.g.timescale.getDt(),this.y+=this.vy*this.g.timescale.getDt(),this.z+=this.vz*this.g.timescale.getDt(),this.life-=this.decay*this.g.timescale.getDt(),this.shrink&&(this.scale=this.life),this.opacity=this.life*this.opacityBase,this.life<=0&&this.destroy()},G.prototype.Particle.prototype.draw=function(){this.g.css(this.elem,{opacity:this.opacity,transform:"translate3d("+this.x+"px, "+this.y+"px, "+this.z+"px) rotateX("+this.rx+"rad) rotateY("+this.ry+"rad) rotateZ("+this.rz+"rad) scaleX("+this.width*this.scale+") scaleY("+this.height*this.scale+")"})},G.prototype.Particle.prototype.destroy=function(){this.g.css(this.elem,{opacity:0,transform:"translate3d(-999px , -999px, 0)"}),this.parent.release(this)},G.prototype.ParticleWhite=function(t){this.g=t,G.prototype.Particle.apply(this,arguments),this.color="#fff",this.g.css(this.elem,"background",this.color)},G.prototype.ParticleWhite.prototype=G.prototype.Particle.prototype,G.prototype.ParticleWhite.prototype.constructor=G.prototype.ParticleWhite,G.prototype.ParticleGreen=function(t){this.g=t,G.prototype.Particle.apply(this,arguments),this.color="hsl(130, 100%, 60%)",this.g.css(this.elem,"background",this.color)},G.prototype.ParticleGreen.prototype=G.prototype.Particle.prototype,G.prototype.ParticleGreen.prototype.constructor=G.prototype.ParticleGreen,G.prototype.ParticleBlue=function(t){this.g=t,G.prototype.Particle.apply(this,arguments),this.color="hsl(200, 100%, 60%)",this.g.css(this.elem,"background",this.color)},G.prototype.ParticleBlue.prototype=G.prototype.Particle.prototype,G.prototype.ParticleBlue.prototype.constructor=G.prototype.ParticleBlue,G.prototype.Pulse=function(t,e){this.g=t,this.parent=e,this.elem=this.g.cE(this.g.stage.elem,"g-pulse"),this.g.css(this.elem,{opacity:0,transform:"translate3d(-999px , -999px, 0)"})},G.prototype.Pulse.prototype.init=function(t){this.width=t.width,this.height=t.height,this.x=t.x,this.y=t.y,this.z=t.z,this.r=t.r,this.shrink=t.shrink,this.decay=t.decay,this.opacityBase=t.opacity,this.life=1,this.scale=1,this.opacity=this.opacityBase},G.prototype.Pulse.prototype.step=function(){this.life-=this.decay*this.g.timescale.getDt(),this.shrink?this.scale=this.life:this.scale=0+(2-2*this.life),this.opacity=this.life*this.opacityBase,this.life<=0&&this.destroy()},G.prototype.Pulse.prototype.draw=function(){this.g.css(this.elem,{opacity:this.opacity,transform:"translate3d("+this.x+"px, "+this.y+"px, "+this.z+"px) rotateZ("+this.r+"rad) scaleX("+this.scale+") scaleY("+this.scale+")"})},G.prototype.Pulse.prototype.destroy=function(){this.g.css(this.elem,{opacity:0,transform:"translate3d(-999px , -999px, 0)"}),this.parent.release(this)},G.prototype.PulseWhite=function(t){this.g=t,G.prototype.Pulse.apply(this,arguments),this.color="#fff",this.g.css(this.elem,"border-color",this.color)},G.prototype.PulseWhite.prototype=G.prototype.Pulse.prototype,G.prototype.PulseWhite.prototype.constructor=G.prototype.PulseWhite,G.prototype.PulseGreen=function(t){this.g=t,G.prototype.Pulse.apply(this,arguments),this.color="hsl(130, 100%, 60%)",this.g.css(this.elem,"border-color",this.color)},G.prototype.PulseGreen.prototype=G.prototype.Pulse.prototype,G.prototype.PulseGreen.prototype.constructor=G.prototype.PulseGreen,G.prototype.PulseBlue=function(t){this.g=t,G.prototype.Pulse.apply(this,arguments),this.color="hsl(200, 100%, 60%)",this.g.css(this.elem,"border-color",this.color)},G.prototype.PulseBlue.prototype=G.prototype.Pulse.prototype,G.prototype.PulseBlue.prototype.constructor=G.prototype.PulseBlue;